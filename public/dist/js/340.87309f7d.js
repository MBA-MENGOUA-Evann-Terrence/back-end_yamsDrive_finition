"use strict";(self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]=self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]||[]).push([[340],{1340:function(e,s,r){r.r(s),r.d(s,{default:function(){return Q}});var i=r(6768);const t={class:"auth-form-container"};function a(e,s,r,a,o,n){const l=(0,i.g2)("register-form");return(0,i.uX)(),(0,i.CE)("div",t,[s[0]||(s[0]=(0,i.Lk)("h2",null,"Créez votre compte",-1)),s[1]||(s[1]=(0,i.Lk)("p",{class:"auth-subtitle"},"Rejoignez Yam's_Drive pour sécuriser vos données",-1)),(0,i.bF)(l,{onRegisterSubmitted:e.handleRegister},null,8,["onRegisterSubmitted"])])}var o=r(4968),n=r(5130),l=r(4232);const c={class:"input-group"},u={class:"input-wrapper"},m={key:0,class:"error-message"},d={class:"input-group"},p={class:"input-wrapper"},v={key:0,class:"error-message"},g={class:"input-group"},h={class:"input-wrapper"},k={key:0,class:"error-message"},b={class:"input-group"},f={class:"input-wrapper"},_=["value"],E={key:0,class:"error-message"},L={class:"terms-group"},y={class:"checkbox-container"},F={key:0,class:"error-message"},C={key:1,class:"success-message"},M=["disabled"],N={key:0},S={key:1},w={class:"auth-switch"};function V(e,s,r,t,a,o){const V=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("form",{onSubmit:s[5]||(s[5]=(0,n.D$)((...s)=>e.handleSubmit&&e.handleSubmit(...s),["prevent"])),class:"auth-form",novalidate:""},[(0,i.Lk)("div",c,[s[7]||(s[7]=(0,i.Lk)("label",{for:"lastName"},"Nom",-1)),(0,i.Lk)("div",u,[s[6]||(s[6]=(0,i.Lk)("i",{class:"fas fa-user input-icon"},null,-1)),(0,i.bo)((0,i.Lk)("input",{class:(0,l.C4)(["input-field",{error:e.validationErrors.nom}]),id:"lastName","onUpdate:modelValue":s[0]||(s[0]=s=>e.registerForm.lastName=s),type:"text",placeholder:"Entrez votre nom",required:""},null,2),[[n.Jo,e.registerForm.lastName]])]),e.validationErrors.nom?((0,i.uX)(),(0,i.CE)("span",m,(0,l.v_)(e.validationErrors.nom[0]),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",d,[s[9]||(s[9]=(0,i.Lk)("label",{for:"firstName"},"Prénom",-1)),(0,i.Lk)("div",p,[s[8]||(s[8]=(0,i.Lk)("i",{class:"fas fa-user input-icon"},null,-1)),(0,i.bo)((0,i.Lk)("input",{class:(0,l.C4)(["input-field",{error:e.validationErrors.prenom}]),id:"firstName","onUpdate:modelValue":s[1]||(s[1]=s=>e.registerForm.firstName=s),type:"text",placeholder:"Entrez votre prénom",required:""},null,2),[[n.Jo,e.registerForm.firstName]])]),e.validationErrors.prenom?((0,i.uX)(),(0,i.CE)("span",v,(0,l.v_)(e.validationErrors.prenom[0]),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",g,[s[11]||(s[11]=(0,i.Lk)("label",{for:"email"},"Email",-1)),(0,i.Lk)("div",h,[s[10]||(s[10]=(0,i.Lk)("i",{class:"fas fa-envelope input-icon"},null,-1)),(0,i.bo)((0,i.Lk)("input",{class:(0,l.C4)(["input-field",{error:e.validationErrors.email}]),id:"email","onUpdate:modelValue":s[2]||(s[2]=s=>e.registerForm.email=s),type:"email",placeholder:"Entrez votre email",required:""},null,2),[[n.Jo,e.registerForm.email]])]),e.validationErrors.email?((0,i.uX)(),(0,i.CE)("span",k,(0,l.v_)(e.validationErrors.email[0]),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",b,[s[14]||(s[14]=(0,i.Lk)("label",{for:"service"},"Service",-1)),(0,i.Lk)("div",f,[s[13]||(s[13]=(0,i.Lk)("i",{class:"fas fa-briefcase input-icon"},null,-1)),(0,i.bo)((0,i.Lk)("select",{class:(0,l.C4)(["input-field",{error:e.validationErrors.service_id}]),id:"service","onUpdate:modelValue":s[3]||(s[3]=s=>e.registerForm.service_id=s),required:""},[s[12]||(s[12]=(0,i.Lk)("option",{value:""},"Choisissez votre service",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.services,e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.nom),9,_))),128))],2),[[n.u1,e.registerForm.service_id]])]),e.validationErrors.service_id?((0,i.uX)(),(0,i.CE)("span",E,(0,l.v_)(e.validationErrors.service_id[0]),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",L,[(0,i.Lk)("label",y,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=s=>e.acceptTerms=s),required:"",class:"checkbox-input"},null,512),[[n.lH,e.acceptTerms]]),s[15]||(s[15]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),s[16]||(s[16]=(0,i.eW)(" J'accepte les ",-1)),s[17]||(s[17]=(0,i.Lk)("a",{href:"#",class:"terms-link"},"conditions d'utilisation",-1))])]),e.errorMessage?((0,i.uX)(),(0,i.CE)("div",F,(0,l.v_)(e.errorMessage),1)):(0,i.Q3)("",!0),e.successMessage?((0,i.uX)(),(0,i.CE)("div",C,(0,l.v_)(e.successMessage),1)):(0,i.Q3)("",!0),(0,i.Lk)("button",{type:"submit",class:"submit-button",disabled:e.isSubmitting},[e.isSubmitting?((0,i.uX)(),(0,i.CE)("span",S,"Inscription en cours...")):((0,i.uX)(),(0,i.CE)("span",N,"S'inscrire"))],8,M),(0,i.Lk)("div",w,[s[19]||(s[19]=(0,i.eW)(" Déjà inscrit ? ",-1)),(0,i.bF)(V,{to:"/connexion"},{default:(0,i.k6)(()=>s[18]||(s[18]=[(0,i.eW)("Se connecter",-1)])),_:1,__:[18]})])],32)}r(8111),r(2489),r(1701);var X=r(4373),z=(0,i.pM)({name:"RegisterForm",emits:["register-submitted"],data(){return{isSubmitting:!1,errorMessage:"",successMessage:"",validationErrors:{},acceptTerms:!1,registerForm:{firstName:"",lastName:"",email:"",service_id:""},services:[]}},mounted(){this.loadServices()},methods:{async loadServices(){try{const e=await X.A.get("/api/services"),s=e.data;let r=[];Array.isArray(s)?r=s:Array.isArray(s?.data)?r=s.data:Array.isArray(s?.results)&&(r=s.results),this.services=r.filter(e=>e&&(e.id||0===e.id)&&(e.nom||e.name)).map(e=>({id:e.id,nom:e.nom||e.name}))}catch(e){console.error("Impossible de charger les services",e),this.services=[]}},validateForm(){return this.errorMessage="",this.validationErrors={},this.registerForm.firstName.trim()?this.registerForm.lastName.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.registerForm.email)?this.registerForm.service_id?!!this.acceptTerms||(this.errorMessage="Veuillez accepter les conditions d'utilisation",!1):(this.errorMessage="Veuillez choisir votre service",!1):(this.errorMessage="Veuillez entrer un email valide",!1):(this.errorMessage="Veuillez entrer votre nom",!1):(this.errorMessage="Veuillez entrer votre prénom",!1)},async handleSubmit(){if(!this.isSubmitting&&this.validateForm()){this.isSubmitting=!0;try{const e={nom:this.registerForm.lastName.trim(),prenom:this.registerForm.firstName.trim(),email:this.registerForm.email.trim().toLowerCase(),service_id:parseInt(this.registerForm.service_id)},s=await X.A.post("/api/utilisateurs/new",e);this.successMessage=s.data.message||"Inscription réussie ! Un email avec votre mot de passe a été envoyé.",this.registerForm={firstName:"",lastName:"",email:"",service_id:""},this.acceptTerms=!1,this.$emit("register-submitted",{success:!0,message:this.successMessage})}catch(e){if(console.error("Erreur lors de l'inscription:",e),e.response&&422===e.response.status&&e.response.data?.errors){this.validationErrors=e.response.data.errors;const s=Object.values(this.validationErrors).flat();this.errorMessage=s.join(" ")}else e.response?.data?.error?this.errorMessage=e.response.data.error:e.response?.data?.message?this.errorMessage=e.response.data.message:this.errorMessage="Une erreur est survenue lors de l'inscription.";this.$emit("register-submitted",{success:!1,message:this.errorMessage})}finally{this.isSubmitting=!1}}}}}),A=r(1241);const I=(0,A.A)(z,[["render",V],["__scopeId","data-v-5c87279e"]]);var R=I,U=(0,i.pM)({name:"InscriptionView",components:{RegisterForm:R},setup(){(0,i.sV)(()=>{o.os.from(".auth-form-container",{opacity:0,y:20,duration:.5,ease:"power2.out"})});const e=e=>{e.success?console.log("Inscription réussie:",e.message):console.error("Échec de l'inscription:",e.message)};return{handleRegister:e}}});const x=(0,A.A)(U,[["render",a],["__scopeId","data-v-2548b284"]]);var Q=x}}]);
//# sourceMappingURL=340.87309f7d.js.map