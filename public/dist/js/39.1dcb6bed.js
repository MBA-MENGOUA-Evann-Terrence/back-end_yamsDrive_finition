"use strict";(self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]=self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]||[]).push([[39],{9069:function(e,t,a){a.d(t,{A:function(){return u}});var s=a(6768),r=a(4232);const i={class:"file-icon-container"},n={key:0,class:"file-extension"};function o(e,t,a,o,c,l){return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("div",{class:(0,r.C4)(["file-icon",e.iconClass])},[e.fileExtension?((0,s.uX)(),(0,s.CE)("span",n,(0,r.v_)(e.fileExtension),1)):(0,s.Q3)("",!0)],2)])}var c=(0,s.pM)({name:"FileIcon",props:{fileName:{type:String,required:!0},fileType:{type:String,default:""}},setup(e){const t=e=>{const t=e.split(".");return t.length>1?t[t.length-1].toLowerCase():""},a=(0,s.EW)(()=>{const a=e.fileType.toLowerCase();if(a.includes("pdf")||a.includes("word")||a.includes("excel")||a.includes("powerpoint")||a.includes("image"))return"";const s=t(e.fileName);return s&&s.length<=4?s:""}),r=(0,s.EW)(()=>{const a=e.fileName.toLowerCase(),s=e.fileType.toLowerCase(),r=t(a);return s.includes("image")||["jpg","jpeg","png","gif","webp"].includes(r)?"image-icon":s.includes("pdf")||"pdf"===r?"pdf-icon":s.includes("word")||["doc","docx"].includes(r)?"word-icon":s.includes("excel")||["xls","xlsx","csv"].includes(r)?"excel-icon":s.includes("powerpoint")||["ppt","pptx"].includes(r)?"powerpoint-icon":s.includes("zip")||["zip","rar","7z"].includes(r)?"zip-icon":s.includes("folder")||s.includes("directory")?"folder-icon":s.includes("text")||["txt","md"].includes(r)?"text-icon":"generic-icon"});return{iconClass:r,fileExtension:a}}}),l=a(1241);const d=(0,l.A)(c,[["render",o],["__scopeId","data-v-febcd1ec"]]);var u=d},9790:function(e,t,a){a.r(t),a.d(t,{default:function(){return N}});var s=a(6768);const r={class:"container-fluid"},i={class:"row"},n={class:"col-12"};function o(e,t,a,o,c,l){const d=(0,s.g2)("SharedDocumentsView");return(0,s.uX)(),(0,s.CE)("div",r,[(0,s.Lk)("div",i,[(0,s.Lk)("div",n,[(0,s.bF)(d)])])])}var c=a(5130),l=a(4232);const d={class:"document-view-container"},u={class:"view-header"},p={class:"card document-management-card"},h={class:"card-body"},m={class:"custom-search-wrapper"},f={class:"file-cell"},g={class:"ms-2"},v={class:"badge bg-secondary"},b={key:0},w={key:1},k={key:2},y={class:"p-2 rounded badge badge-secondary"},_={key:0},C={key:1,class:"text-muted"},E={key:2,class:"text-muted"};function x(e,t,a,r,i,n){const o=(0,s.g2)("FileIcon"),x=(0,s.g2)("AsdecodeTable");return(0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("div",u,[t[3]||(t[3]=(0,s.Lk)("h1",{class:"view-title"},"Partag√©s avec moi",-1)),(0,s.Lk)("button",{id:"refreshshared",onClick:t[0]||(t[0]=(...t)=>e.refreshData&&e.refreshData(...t)),class:"d-none"},"Rafra√Æchir")]),(0,s.Lk)("div",p,[(0,s.Lk)("div",h,[(0,s.Lk)("div",m,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=t=>e.searchQuery=t),class:"form-control form-control-sm",placeholder:"Rechercher par nom de fichier ou propri√©taire..."},null,512),[[c.Jo,e.searchQuery]]),e.searchQuery?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"btn btn-sm btn-secondary",onClick:t[2]||(t[2]=(...t)=>e.clearSearch&&e.clearSearch(...t))},t[4]||(t[4]=[(0,s.Lk)("i",{class:"fas fa-times"},null,-1),(0,s.eW)(" Effacer ",-1)]))):(0,s.Q3)("",!0)]),(0,s.bF)(x,{ref:"datatable",columns:e.columns,url:e.computedUrl,"api-client":e.apiClient,table:"shared",onSetTotalRecords:e.updateLines,onRowClick:e.showLine,onSetSelectedRows:e.getSelection,"show-top-stats":!1,"show-bottom-stats":!1},{nom:(0,s.k6)(e=>[(0,s.Lk)("div",f,[(0,s.bF)(o,{fileName:e.data.nom},null,8,["fileName"]),(0,s.Lk)("span",g,(0,l.v_)(e.data.nom),1)])]),type_lisible:(0,s.k6)(t=>[(0,s.Lk)("span",v,(0,l.v_)(e.getFileType(t.data.nom)),1)]),proprietaire:(0,s.k6)(e=>[e.data.user&&e.data.user.prenom&&e.data.user.nom?((0,s.uX)(),(0,s.CE)("span",b,(0,l.v_)(e.data.user.prenom)+" "+(0,l.v_)(e.data.user.nom),1)):e.data.shared_by?((0,s.uX)(),(0,s.CE)("span",w,(0,l.v_)(e.data.shared_by.name),1)):((0,s.uX)(),(0,s.CE)("span",k,"Inconnu"))]),taille:(0,s.k6)(t=>[(0,s.Lk)("span",null,(0,l.v_)(e.formatSize(t.data.taille)),1)]),date_partage:(0,s.k6)(t=>[(0,s.Lk)("span",y,(0,l.v_)(e.formatDate(t.data.date_partage||t.data.created_at)),1)]),service:(0,s.k6)(e=>[e.data.service?((0,s.uX)(),(0,s.CE)("span",_,(0,l.v_)(e.data.service.nom),1)):e.data.service_id?((0,s.uX)(),(0,s.CE)("span",C,"Service #"+(0,l.v_)(e.data.service_id),1)):((0,s.uX)(),(0,s.CE)("span",E,"Aucun service"))]),_:1},8,["columns","url","api-client","onSetTotalRecords","onRowClick","onSetSelectedRows"])])])])}a(4603),a(7566),a(8721);var D=a(139),L=a(9069),S=a(1526),T=a(1804),F=(0,s.pM)({name:"SharedDocumentsView",components:{FileIcon:L.A},data(){return{apiClient:S.A,lines:0,selection:[],searchQuery:"",searchTimeout:null,filters:{},columns:[{key:"nom",label:"Fichier"},{key:"type_lisible",label:"Type"},{key:"taille",label:"Taille"},{key:"service",label:"Service"},{key:"proprietaire",label:"Propri√©taire"},{key:"date_partage",label:"Partag√© le"}]}},computed:{computedUrl(){const e="/api/documents/shared-with-me",t=new URLSearchParams;this.searchQuery&&t.append("q",this.searchQuery);const a=t.toString();return a?`${e}?${a}`:e}},watch:{searchQuery(){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.$nextTick(()=>{this.$refs.datatable&&this.$refs.datatable.fetchData&&this.$refs.datatable.fetchData()})},500)}},methods:{async markAllNotificationsAsRead(){try{await S.A.post("/system/notifications/mark-all-read"),console.log("‚úÖ Toutes les notifications ont √©t√© marqu√©es comme lues"),window.dispatchEvent(new CustomEvent("notifications-read"))}catch(e){console.error("Erreur lors du marquage des notifications comme lues:",e)}},clearSearch(){clearTimeout(this.searchTimeout),this.searchQuery="",this.$nextTick(()=>{this.$refs.datatable&&this.$refs.datatable.fetchData&&this.$refs.datatable.fetchData()})},refreshData(){this.$refs.datatable&&this.$refs.datatable.fetchData()},showLine(e){const t=e.nom.split(".").pop().toLowerCase(),a=["png","jpg","jpeg","gif","webp"].includes(t),s=a?"70vw":"50vw";this.$dialog.open(D.A,{props:{header:"D√©tails du document",style:{width:s},modal:!0,maximizable:!0,closeOnEscape:!0},data:{document:e,table:"shared",source:"shared",showAddButton:!1}})},updateLines(e){this.lines=e},formatSize(e){if(!e)return"0 Bytes";if(0===e)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB","TB"],s=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,s)).toFixed(2))+" "+a[s]},getFileType(e){if(!e)return"Inconnu";const t=e.split(".").pop().toLowerCase(),a={png:"Image PNG",jpg:"Image JPG",jpeg:"Image JPEG",gif:"Image GIF",pdf:"Document PDF",doc:"Document Word",docx:"Document Word",xls:"Fichier Excel",xlsx:"Fichier Excel",ppt:"Pr√©sentation PowerPoint",pptx:"Pr√©sentation PowerPoint",zip:"Archive ZIP",rar:"Archive RAR",txt:"Fichier Texte"};return a[t]||`Fichier ${t.toUpperCase()}`},formatDate(e){if(!e)return"Date inconnue";const t=new Date(e);return t.toLocaleDateString("fr-FR",{day:"2-digit",month:"long",year:"numeric"})},getSelection(e){this.selection=e},applyFilters(e){console.log("üîç Filtres appliqu√©s dans SharedDocumentsView:",e),this.$nextTick(()=>{this.$refs.datatable&&this.$refs.datatable.fetchData&&this.$refs.datatable.fetchData()})},handleGlobalFiltersChange(e){const t=e.detail;console.log("üåç SharedDocumentsView a re√ßu les filtres globaux:",t),this.filters=t}},mounted(){this.markAllNotificationsAsRead(),T.B.on(T.q.DOCUMENT_DELETED,this.refreshData),window.addEventListener("global-filters-change",this.handleGlobalFiltersChange);try{const e=localStorage.getItem("globalFilters");e&&(this.filters=JSON.parse(e))}catch(e){console.error("Erreur lors de la restauration des filtres:",e)}},beforeUnmount(){T.B.off(T.q.DOCUMENT_DELETED,this.refreshData),window.removeEventListener("global-filters-change",this.handleGlobalFiltersChange)}}),A=a(1241);const $=(0,A.A)(F,[["render",x],["__scopeId","data-v-bd5738ee"]]);var I=$,P=(0,s.pM)({name:"PartageIndex",components:{SharedDocumentsView:I}});const R=(0,A.A)(P,[["render",o],["__scopeId","data-v-7c38e458"]]);var N=R}}]);
//# sourceMappingURL=39.1dcb6bed.js.map