"use strict";(self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]=self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]||[]).push([[488],{4664:function(e,t,s){s.r(t),s.d(t,{default:function(){return E}});var n=s(6768),i=s(4232),o=s(5130);const r={class:"card"},a={class:"card-header d-flex justify-content-between align-items-center"},l={key:0,class:"card-body bg-light border-bottom"},c={class:"text-dark"},d={class:"card-body"},u={class:"file-cell"},p={class:"ms-2"},m={class:"badge bg-secondary"},b={key:0},g={key:1,class:"text-muted"},h={key:2,class:"text-muted"},f={class:"px-6 py-4 text-sm font-medium text-right whitespace-nowrap space-x-2"},v={class:"badge bg-warning text-dark"},w=["onClick","disabled"];function k(e,t,s,k,x,y){const C=(0,n.g2)("FileIcon"),L=(0,n.g2)("AsdecodeTable");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.Lk)("div",a,[t[1]||(t[1]=(0,n.Lk)("h1",{class:"card-title mb-0"},"Corbeille",-1)),(0,n.Lk)("button",{class:"btn btn-outline-secondary btn-sm",onClick:t[0]||(t[0]=t=>e.showDebug=!e.showDebug)}," Afficher/Cacher Débogage ")]),e.showDebug?((0,n.uX)(),(0,n.CE)("div",l,[t[10]||(t[10]=(0,n.Lk)("h5",{class:"text-dark"},"Informations de débogage",-1)),(0,n.Lk)("pre",c,[t[2]||(t[2]=(0,n.eW)("URL passée au composant AsdecodeTable: ",-1)),(0,n.Lk)("strong",null,(0,i.v_)(e.tableUrl),1),t[3]||(t[3]=(0,n.eW)("\n\nConfiguration du proxy (dans vue.config.js) pour cette URL:\n",-1)),t[4]||(t[4]=(0,n.Lk)("strong",null,"'/api': { target: 'http://127.0.0.1:8000' }",-1)),t[5]||(t[5]=(0,n.eW)("\n\nLe navigateur doit donc appeler ",-1)),t[6]||(t[6]=(0,n.Lk)("strong",null,"/api/documents/trash",-1)),t[7]||(t[7]=(0,n.eW)(", et le proxy doit le rediriger vers ",-1)),t[8]||(t[8]=(0,n.Lk)("strong",null,"http://127.0.0.1:8000/api/documents/trash",-1)),t[9]||(t[9]=(0,n.eW)(".",-1))])])):(0,n.Q3)("",!0),(0,n.Lk)("div",d,[((0,n.uX)(),(0,n.Wv)(L,{ref:"trashTable",key:e.tableKey,columns:e.columns,url:e.tableUrl,table:"documents","show-top-stats":!1,"show-bottom-stats":!1,searchable:!1,onRowClick:e.showLine},{nom:(0,n.k6)(({data:e})=>[(0,n.Lk)("div",u,[(0,n.bF)(C,{fileName:e.nom},null,8,["fileName"]),(0,n.Lk)("span",p,(0,i.v_)(e.nom),1)])]),type_lisible:(0,n.k6)(({data:t})=>[(0,n.Lk)("span",m,(0,i.v_)(e.getFileType(t.nom)),1)]),service:(0,n.k6)(({data:e})=>[e.service?((0,n.uX)(),(0,n.CE)("span",b,(0,i.v_)(e.service.nom),1)):e.service_id?((0,n.uX)(),(0,n.CE)("span",g,"Service #"+(0,i.v_)(e.service_id),1)):((0,n.uX)(),(0,n.CE)("span",h,"Aucun service"))]),deleted_at:(0,n.k6)(({data:s})=>[(0,n.Lk)("td",f,[(0,n.Lk)("span",v,(0,i.v_)(e.formatDate(s.deleted_at)),1),(0,n.Lk)("button",{onClick:(0,o.D$)(t=>e.restoreDocument(s),["stop"]),disabled:e.isRowLoading(s),class:"btn btn-sm btn-outline-primary"},t[11]||(t[11]=[(0,n.Lk)("i",{class:"pi pi-replay me-1"},null,-1),(0,n.eW)(" Restaurer ",-1)]),8,w)])]),_:1},8,["columns","url","onRowClick"]))])])}var x=s(139),y=s(9069),C=s(1804),L=(0,n.pM)({name:"CorbeilleView",components:{FileIcon:y.A},data(){return{showDebug:!1,tableUrl:"/api/documents/trash",tableKey:0,loadingMap:{},columns:[{key:"nom",label:"Fichier",headerClass:"text-start",cellClass:"text-start align-middle"},{key:"type_lisible",label:"Type",headerClass:"text-center",cellClass:"text-center align-middle"},{key:"service",label:"Service",headerClass:"text-center",cellClass:"text-center align-middle"},{key:"deleted_at",label:"Supprimé le",headerClass:"text-center",cellClass:"text-center align-middle"}]}},methods:{async restoreDocument(e){if(!this.isRowLoading(e)){this.setRowLoading(e.uuid,!0);try{await this.axios.post(`/api/documents/${e.uuid}/restore`),this.$toast.add({severity:"success",summary:"Succès",detail:"Document restauré avec succès.",life:3e3}),C.B.emit(C.q.DOCUMENT_RESTORED,e.uuid)}catch(t){console.error("Erreur détaillée lors de la restauration du document:",t.response||t),this.$toast.add({severity:"error",summary:"Erreur",detail:"Erreur lors de la restauration du document.",life:3e3})}finally{this.setRowLoading(e.uuid,!1)}}},isRowLoading(e){return this.loadingMap[e.uuid]||!1},setRowLoading(e,t){this.loadingMap[e]=t},refreshTable(){this.tableKey++},showLine(e){const t=e.nom.split(".").pop().toLowerCase(),s=["png","jpg","jpeg","gif","webp"].includes(t),n=s?"70vw":"50vw";this.$dialog.open(x.A,{props:{header:"Document dans la corbeille",style:{width:n},modal:!0,maximizable:!0,closeOnEscape:!0},data:{document:e,source:"trash",table:"trash"}})},formatDate(e){return e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"}):""},getFileType(e){if(!e)return"Inconnu";const t=e.split(".").pop().toLowerCase(),s={png:"Image PNG",jpg:"Image JPG",jpeg:"Image JPEG",gif:"Image GIF",pdf:"Document PDF",doc:"Document Word",docx:"Document Word",xls:"Fichier Excel",xlsx:"Fichier Excel",ppt:"Présentation PowerPoint",pptx:"Présentation PowerPoint",zip:"Archive ZIP",rar:"Archive RAR",txt:"Fichier Texte"};return s[t]||`Fichier ${t.toUpperCase()}`}},mounted(){this.unsubscribeRestore=C.B.on(C.q.DOCUMENT_RESTORED,e=>{console.log("CorbeilleView: Document restauré avec UUID:",e),this.refreshTable()}),this.unsubscribeForceDelete=C.B.on(C.q.DOCUMENT_FORCE_DELETED,e=>{console.log("CorbeilleView: Document supprimé définitivement avec UUID:",e),this.refreshTable()})},unmounted(){this.unsubscribeRestore&&this.unsubscribeRestore(),this.unsubscribeForceDelete&&this.unsubscribeForceDelete()}}),_=s(1241);const D=(0,_.A)(L,[["render",k],["__scopeId","data-v-25255e24"]]);var E=D},9069:function(e,t,s){s.d(t,{A:function(){return u}});var n=s(6768),i=s(4232);const o={class:"file-icon-container"},r={key:0,class:"file-extension"};function a(e,t,s,a,l,c){return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.Lk)("div",{class:(0,i.C4)(["file-icon",e.iconClass])},[e.fileExtension?((0,n.uX)(),(0,n.CE)("span",r,(0,i.v_)(e.fileExtension),1)):(0,n.Q3)("",!0)],2)])}var l=(0,n.pM)({name:"FileIcon",props:{fileName:{type:String,required:!0},fileType:{type:String,default:""}},setup(e){const t=e=>{const t=e.split(".");return t.length>1?t[t.length-1].toLowerCase():""},s=(0,n.EW)(()=>{const s=e.fileType.toLowerCase();if(s.includes("pdf")||s.includes("word")||s.includes("excel")||s.includes("powerpoint")||s.includes("image"))return"";const n=t(e.fileName);return n&&n.length<=4?n:""}),i=(0,n.EW)(()=>{const s=e.fileName.toLowerCase(),n=e.fileType.toLowerCase(),i=t(s);return n.includes("image")||["jpg","jpeg","png","gif","webp"].includes(i)?"image-icon":n.includes("pdf")||"pdf"===i?"pdf-icon":n.includes("word")||["doc","docx"].includes(i)?"word-icon":n.includes("excel")||["xls","xlsx","csv"].includes(i)?"excel-icon":n.includes("powerpoint")||["ppt","pptx"].includes(i)?"powerpoint-icon":n.includes("zip")||["zip","rar","7z"].includes(i)?"zip-icon":n.includes("folder")||n.includes("directory")?"folder-icon":n.includes("text")||["txt","md"].includes(i)?"text-icon":"generic-icon"});return{iconClass:i,fileExtension:s}}}),c=s(1241);const d=(0,c.A)(l,[["render",a],["__scopeId","data-v-febcd1ec"]]);var u=d}}]);
//# sourceMappingURL=488.036b525d.js.map