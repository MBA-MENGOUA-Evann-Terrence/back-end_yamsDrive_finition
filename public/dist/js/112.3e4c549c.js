"use strict";(self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]=self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]||[]).push([[112],{1175:function(e,s,t){t.r(s),t.d(s,{default:function(){return ve}});var l=t(6768),a=t(5130),i=t(4232);const n={class:"dashboard-layout"},o={class:"options-card"},r={class:"new-item-options"},c={class:"dashboard-header"},u={class:"header-center"},d={class:"header-right"},h={class:"user-name"},p={class:"universal-filters-container"},v={class:"dashboard-container"},f={class:"dashboard-sidebar"},m={class:"sidebar-header"},k={class:"sidebar-nav"},g={key:0},b={key:1},L={key:2},y={key:3},C={key:0,class:"notification-badge"},w={class:"sidebar-footer"},F={class:"dashboard-content"};function E(e,s,t,E,S,_){const x=(0,l.g2)("Dialog"),T=(0,l.g2)("router-link"),$=(0,l.g2)("DocumentFilters"),A=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.CE)("div",n,[(0,l.bF)(x,{visible:e.displayNewModal,"onUpdate:visible":s[5]||(s[5]=s=>e.displayNewModal=s),header:"CrÃ©er un nouveau",modal:!0,dismissableMask:!0,closeOnEscape:!0,style:{width:"400px"},showHeader:!0,breakpoints:{"960px":"75vw","640px":"90vw"},draggable:!1,class:"new-item-modal"},{default:(0,l.k6)(()=>[(0,l.Lk)("div",o,[(0,l.Lk)("div",r,[(0,l.Lk)("div",{class:"new-item-option",onClick:s[0]||(s[0]=(...s)=>e.createNewFolder&&e.createNewFolder(...s))},s[12]||(s[12]=[(0,l.Lk)("div",{class:"icon-container folder-icon"},[(0,l.Lk)("i",{class:"fas fa-folder"})],-1),(0,l.Lk)("span",null,"Nouveau Dossier",-1)])),(0,l.Lk)("div",{class:"new-item-option",onClick:s[1]||(s[1]=(...s)=>e.uploadFile&&e.uploadFile(...s))},s[13]||(s[13]=[(0,l.Lk)("div",{class:"icon-container upload-icon"},[(0,l.Lk)("i",{class:"fas fa-upload"})],-1),(0,l.Lk)("span",null,"Importer un Fichier",-1)])),(0,l.Lk)("div",{class:"new-item-option",onClick:s[2]||(s[2]=(...s)=>e.createNewDocument&&e.createNewDocument(...s))},s[14]||(s[14]=[(0,l.Lk)("div",{class:"icon-container doc-icon"},[(0,l.Lk)("i",{class:"fas fa-file-word"})],-1),(0,l.Lk)("span",null,"Document Google",-1)])),(0,l.Lk)("div",{class:"new-item-option",onClick:s[3]||(s[3]=(...s)=>e.createNewSpreadsheet&&e.createNewSpreadsheet(...s))},s[15]||(s[15]=[(0,l.Lk)("div",{class:"icon-container sheet-icon"},[(0,l.Lk)("i",{class:"fas fa-file-excel"})],-1),(0,l.Lk)("span",null,"Feuille de calcul",-1)])),(0,l.Lk)("div",{class:"new-item-option",onClick:s[4]||(s[4]=(...s)=>e.createNewPresentation&&e.createNewPresentation(...s))},s[16]||(s[16]=[(0,l.Lk)("div",{class:"icon-container slide-icon"},[(0,l.Lk)("i",{class:"fas fa-file-powerpoint"})],-1),(0,l.Lk)("span",null,"PrÃ©sentation",-1)]))])])]),_:1},8,["visible"]),(0,l.Lk)("header",c,[s[19]||(s[19]=(0,l.Lk)("div",{class:"header-left"},[(0,l.Lk)("i",{class:"fas fa-cloud text-primary me-2"}),(0,l.Lk)("span",{class:"fw-bold"},"Yam'sDrive")],-1)),(0,l.Lk)("div",u,[(0,l.Lk)("form",{class:"search-bar",onSubmit:s[8]||(s[8]=(0,a.D$)((...s)=>e.submitGlobalSearch&&e.submitGlobalSearch(...s),["prevent"]))},[s[17]||(s[17]=(0,l.Lk)("i",{class:"fas fa-search search-icon"},null,-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",class:"search-input","onUpdate:modelValue":s[6]||(s[6]=s=>e.globalQuery=s),placeholder:"Rechercher dans toute l'application...",onInput:s[7]||(s[7]=(...s)=>e.onGlobalSearchInput&&e.onGlobalSearchInput(...s))},null,544),[[a.Jo,e.globalQuery]])],32)]),(0,l.Lk)("div",d,[(0,l.bF)(T,{to:"/dashboard/profil",class:"user-profile"},{default:(0,l.k6)(()=>[(0,l.Lk)("span",h,(0,i.v_)(e.userName),1),s[18]||(s[18]=(0,l.Lk)("div",{class:"user-avatar"},[(0,l.Lk)("i",{class:"fas fa-user"})],-1))]),_:1,__:[18]})])]),(0,l.Lk)("div",p,[(0,l.bF)($,{modelValue:e.globalFilters,"onUpdate:modelValue":s[9]||(s[9]=s=>e.globalFilters=s),onFilterChange:e.onFiltersChange},null,8,["modelValue","onFilterChange"])]),(0,l.Lk)("div",v,[(0,l.Lk)("aside",f,[(0,l.Lk)("div",m,[(0,l.Lk)("button",{onClick:s[10]||(s[10]=(...s)=>e.showCreateModal&&e.showCreateModal(...s)),class:"new-btn"},s[20]||(s[20]=[(0,l.Lk)("i",{class:"fas fa-plus"},null,-1),(0,l.eW)(" Nouveau ",-1)]))]),(0,l.Lk)("nav",k,[(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.bF)(T,{to:"/home",class:"nav-item"},{default:(0,l.k6)(()=>s[21]||(s[21]=[(0,l.Lk)("i",{class:"fas fa-home"},null,-1),(0,l.Lk)("span",null,"Accueil",-1)])),_:1,__:[21]})]),e.isAdmin?((0,l.uX)(),(0,l.CE)("li",g,[(0,l.bF)(T,{to:"/dashboard/statistiques",class:"nav-item"},{default:(0,l.k6)(()=>s[22]||(s[22]=[(0,l.Lk)("i",{class:"fas fa-chart-bar"},null,-1),(0,l.Lk)("span",null,"Statistiques",-1)])),_:1,__:[22]})])):(0,l.Q3)("",!0),e.isAdmin?((0,l.uX)(),(0,l.CE)("li",b,[(0,l.bF)(T,{to:"/dashboard/flux-donnees",class:"nav-item"},{default:(0,l.k6)(()=>s[23]||(s[23]=[(0,l.Lk)("i",{class:"fas fa-stream"},null,-1),(0,l.Lk)("span",null,"Flux de donnÃ©es",-1)])),_:1,__:[23]})])):(0,l.Q3)("",!0),e.isAdmin?((0,l.uX)(),(0,l.CE)("li",L,[(0,l.bF)(T,{to:"/dashboard/gestionutilisateur",class:"nav-item"},{default:(0,l.k6)(()=>s[24]||(s[24]=[(0,l.Lk)("i",{class:"fas fa-users-cog"},null,-1),(0,l.Lk)("span",null,"Gestion Utilisateur",-1)])),_:1,__:[24]})])):(0,l.Q3)("",!0),e.isAdmin?((0,l.uX)(),(0,l.CE)("li",y,[(0,l.bF)(T,{to:"/dashboard/services",class:"nav-item"},{default:(0,l.k6)(()=>s[25]||(s[25]=[(0,l.Lk)("i",{class:"fas fa-cogs"},null,-1),(0,l.Lk)("span",null,"Gestion des Services",-1)])),_:1,__:[25]})])):(0,l.Q3)("",!0),(0,l.Lk)("li",null,[(0,l.bF)(T,{to:"/dashboard/documents",class:"nav-item"},{default:(0,l.k6)(()=>s[26]||(s[26]=[(0,l.Lk)("i",{class:"fas fa-folder"},null,-1),(0,l.Lk)("span",null,"Mes documents",-1)])),_:1,__:[26]})]),(0,l.Lk)("li",null,[(0,l.bF)(T,{to:"/dashboard/partage",class:"nav-item"},{default:(0,l.k6)(()=>[s[27]||(s[27]=(0,l.Lk)("i",{class:"fas fa-share-alt"},null,-1)),s[28]||(s[28]=(0,l.Lk)("span",null,"PartagÃ©s avec moi",-1)),e.unreadCount>0?((0,l.uX)(),(0,l.CE)("span",C,(0,i.v_)(e.unreadCount),1)):(0,l.Q3)("",!0)]),_:1,__:[27,28]})]),(0,l.Lk)("li",null,[(0,l.bF)(T,{to:"/dashboard/recent",class:"nav-item"},{default:(0,l.k6)(()=>s[29]||(s[29]=[(0,l.Lk)("i",{class:"fas fa-clock"},null,-1),(0,l.Lk)("span",null,"RÃ©cents",-1)])),_:1,__:[29]})]),(0,l.Lk)("li",null,[(0,l.bF)(T,{to:"/dashboard/corbeille",class:"nav-item"},{default:(0,l.k6)(()=>s[30]||(s[30]=[(0,l.Lk)("i",{class:"fas fa-trash"},null,-1),(0,l.Lk)("span",null,"Corbeille",-1)])),_:1,__:[30]})]),(0,l.Lk)("li",null,[(0,l.bF)(T,{to:"/dashboard/gestionutilisateur/domaine",class:"nav-item"},{default:(0,l.k6)(()=>s[31]||(s[31]=[(0,l.Lk)("i",{class:"fas fa-globe"},null,-1),(0,l.Lk)("span",null,"Parametres",-1)])),_:1,__:[31]})])]),(0,l.Lk)("div",w,[(0,l.Lk)("button",{onClick:s[11]||(s[11]=(...s)=>e.logout&&e.logout(...s)),class:"logout-button"},s[32]||(s[32]=[(0,l.Lk)("i",{class:"fas fa-sign-out-alt"},null,-1),(0,l.Lk)("span",null,"DÃ©connexion",-1)]))])])]),(0,l.Lk)("main",F,[(0,l.bF)(A,null,{default:(0,l.k6)(({Component:e})=>[(0,l.bF)(a.eB,{name:"dashboard-view",mode:"out-in",appear:""},{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.Wv)((0,l.$y)(e)))]),_:2},1024)]),_:1})])])])}t(4114);var S=t(7674),_=t(5841),x=t(2151),T=t(2576);const $={class:"document-filters"},A={class:"filters-container"},D={key:0,class:"selected-badge"},P={key:0,class:"dropdown-menu show"},I={class:"dropdown-header"},N=["onClick"],X={key:0,class:"fas fa-check ms-auto"},U={key:0,class:"selected-badge"},Q={key:0,class:"dropdown-menu show"},V={class:"dropdown-header"},M={class:"search-box"},O={class:"dropdown-items-list"},R={key:0,class:"loading-item"},z={key:1,class:"empty-item"},q=["onClick"],G={class:"person-info"},B={class:"person-name"},W={class:"person-email"},H={key:0,class:"fas fa-check ms-auto"},J={key:0,class:"selected-badge"},K={key:0,class:"dropdown-menu show"},j={class:"dropdown-header"},Y={class:"dropdown-items-list"},Z={key:0,class:"loading-item"},ee={key:1,class:"empty-item"},se=["onClick"],te={key:0,class:"fas fa-check ms-auto"},le={key:0,class:"access-denied-message"};function ae(e,s,t,n,o,r){return(0,l.uX)(),(0,l.CE)("div",$,[(0,l.Lk)("div",A,[(0,l.Lk)("div",{class:(0,i.C4)(["filter-dropdown",{active:"type"===e.activeFilter}])},[(0,l.Lk)("button",{class:(0,i.C4)(["filter-button",{"has-selection":e.selectedType}]),onClick:s[0]||(s[0]=s=>e.toggleFilter("type"))},[s[9]||(s[9]=(0,l.Lk)("i",{class:"fas fa-file-alt me-2"},null,-1)),s[10]||(s[10]=(0,l.Lk)("span",null,"Type de document",-1)),e.selectedType?((0,l.uX)(),(0,l.CE)("span",D,(0,i.v_)(e.getTypeLabel(e.selectedType)),1)):(0,l.Q3)("",!0),s[11]||(s[11]=(0,l.Lk)("i",{class:"fas fa-chevron-down ms-2"},null,-1))],2),"type"===e.activeFilter?((0,l.uX)(),(0,l.CE)("div",P,[(0,l.Lk)("div",I,[s[13]||(s[13]=(0,l.Lk)("span",null,"SÃ©lectionner un type",-1)),e.selectedType?((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:s[1]||(s[1]=(0,a.D$)(s=>e.clearFilter("type"),["stop"])),class:"clear-btn"},s[12]||(s[12]=[(0,l.Lk)("i",{class:"fas fa-times"},null,-1)]))):(0,l.Q3)("",!0)]),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.documentTypes,s=>((0,l.uX)(),(0,l.CE)("div",{class:(0,i.C4)(["dropdown-item",{active:e.selectedType===s.value}]),key:s.value,onClick:t=>e.selectType(s.value)},[(0,l.Lk)("i",{class:(0,i.C4)([s.icon,"me-2"])},null,2),(0,l.Lk)("span",null,(0,i.v_)(s.label),1),e.selectedType===s.value?((0,l.uX)(),(0,l.CE)("i",X)):(0,l.Q3)("",!0)],10,N))),128))])):(0,l.Q3)("",!0)],2),(0,l.Lk)("div",{class:(0,i.C4)(["filter-dropdown",{active:"person"===e.activeFilter}])},[(0,l.Lk)("button",{class:(0,i.C4)(["filter-button",{"has-selection":e.selectedPerson}]),onClick:s[2]||(s[2]=s=>e.toggleFilter("person"))},[s[14]||(s[14]=(0,l.Lk)("i",{class:"fas fa-user me-2"},null,-1)),s[15]||(s[15]=(0,l.Lk)("span",null,"Personne",-1)),e.selectedPerson?((0,l.uX)(),(0,l.CE)("span",U,(0,i.v_)(e.getPersonLabel(e.selectedPerson)),1)):(0,l.Q3)("",!0),s[16]||(s[16]=(0,l.Lk)("i",{class:"fas fa-chevron-down ms-2"},null,-1))],2),"person"===e.activeFilter?((0,l.uX)(),(0,l.CE)("div",Q,[(0,l.Lk)("div",V,[s[18]||(s[18]=(0,l.Lk)("span",null,"SÃ©lectionner une personne",-1)),e.selectedPerson?((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:s[3]||(s[3]=(0,a.D$)(s=>e.clearFilter("person"),["stop"])),class:"clear-btn"},s[17]||(s[17]=[(0,l.Lk)("i",{class:"fas fa-times"},null,-1)]))):(0,l.Q3)("",!0)]),(0,l.Lk)("div",M,[s[19]||(s[19]=(0,l.Lk)("i",{class:"fas fa-search"},null,-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=s=>e.personSearch=s),placeholder:"Rechercher une personne...",onClick:s[5]||(s[5]=(0,a.D$)(()=>{},["stop"]))},null,512),[[a.Jo,e.personSearch]])]),(0,l.Lk)("div",O,[e.loadingPersons?((0,l.uX)(),(0,l.CE)("div",R,s[20]||(s[20]=[(0,l.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,l.eW)(" Chargement... ",-1)]))):0===e.filteredPersons.length?((0,l.uX)(),(0,l.CE)("div",z," Aucune personne trouvÃ©e ")):((0,l.uX)(!0),(0,l.CE)(l.FK,{key:2},(0,l.pI)(e.filteredPersons,t=>((0,l.uX)(),(0,l.CE)("div",{class:(0,i.C4)(["dropdown-item",{active:e.selectedPerson===t.id}]),key:t.id,onClick:s=>e.selectPerson(t.id)},[s[21]||(s[21]=(0,l.Lk)("div",{class:"person-avatar"},[(0,l.Lk)("i",{class:"fas fa-user"})],-1)),(0,l.Lk)("div",G,[(0,l.Lk)("div",B,(0,i.v_)(t.prenom)+" "+(0,i.v_)(t.nom),1),(0,l.Lk)("div",W,(0,i.v_)(t.email),1)]),e.selectedPerson===t.id?((0,l.uX)(),(0,l.CE)("i",H)):(0,l.Q3)("",!0)],10,q))),128))])])):(0,l.Q3)("",!0)],2),(0,l.Lk)("div",{class:(0,i.C4)(["filter-dropdown",{active:"service"===e.activeFilter}])},[(0,l.Lk)("button",{class:(0,i.C4)(["filter-button",{"has-selection":e.selectedService}]),onClick:s[6]||(s[6]=s=>e.toggleFilter("service"))},[s[22]||(s[22]=(0,l.Lk)("i",{class:"fas fa-building me-2"},null,-1)),s[23]||(s[23]=(0,l.Lk)("span",null,"Service",-1)),e.selectedService?((0,l.uX)(),(0,l.CE)("span",J,(0,i.v_)(e.getServiceLabel(e.selectedService)),1)):(0,l.Q3)("",!0),s[24]||(s[24]=(0,l.Lk)("i",{class:"fas fa-chevron-down ms-2"},null,-1))],2),"service"===e.activeFilter?((0,l.uX)(),(0,l.CE)("div",K,[(0,l.Lk)("div",j,[s[26]||(s[26]=(0,l.Lk)("span",null,"SÃ©lectionner un service",-1)),e.selectedService?((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:s[7]||(s[7]=(0,a.D$)(s=>e.clearFilter("service"),["stop"])),class:"clear-btn"},s[25]||(s[25]=[(0,l.Lk)("i",{class:"fas fa-times"},null,-1)]))):(0,l.Q3)("",!0)]),(0,l.Lk)("div",Y,[e.loadingServices?((0,l.uX)(),(0,l.CE)("div",Z,s[27]||(s[27]=[(0,l.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,l.eW)(" Chargement... ",-1)]))):0===e.services.length?((0,l.uX)(),(0,l.CE)("div",ee," Aucun service trouvÃ© ")):((0,l.uX)(!0),(0,l.CE)(l.FK,{key:2},(0,l.pI)(e.services,t=>((0,l.uX)(),(0,l.CE)("div",{class:(0,i.C4)(["dropdown-item",{active:e.selectedService===t.id}]),key:t.id,onClick:s=>e.selectService(t.id)},[s[28]||(s[28]=(0,l.Lk)("i",{class:"fas fa-building me-2"},null,-1)),(0,l.Lk)("span",null,(0,i.v_)(t.nom),1),e.selectedService===t.id?((0,l.uX)(),(0,l.CE)("i",te)):(0,l.Q3)("",!0)],10,se))),128))])])):(0,l.Q3)("",!0)],2),e.hasActiveFilters?((0,l.uX)(),(0,l.CE)("button",{key:0,class:"reset-filters-btn",onClick:s[8]||(s[8]=(...s)=>e.resetAllFilters&&e.resetAllFilters(...s)),title:"RÃ©initialiser tous les filtres"},s[29]||(s[29]=[(0,l.Lk)("i",{class:"fas fa-redo-alt me-2"},null,-1),(0,l.eW)(" RÃ©initialiser ",-1)]))):(0,l.Q3)("",!0)]),e.showServiceAccessDenied?((0,l.uX)(),(0,l.CE)("div",le,s[30]||(s[30]=[(0,l.Lk)("i",{class:"fas fa-exclamation-triangle me-2"},null,-1),(0,l.eW)(" Vous n'appartenez pas Ã  ce service, vous n'avez accÃ¨s Ã  aucun rÃ©sultat. ",-1)]))):(0,l.Q3)("",!0)])}t(8111),t(2489),t(116);var ie=t(1526),ne=(0,l.pM)({name:"DocumentFilters",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue","filter-change"],data(){return{activeFilter:null,selectedType:null,selectedPerson:null,selectedService:null,personSearch:"",persons:[],services:[],currentUserService:null,loadingPersons:!1,loadingServices:!1,showServiceAccessDenied:!1,documentTypes:[{value:"pdf",label:"PDF",icon:"fas fa-file-pdf text-danger"},{value:"image",label:"Images",icon:"fas fa-file-image text-info"},{value:"word",label:"Word",icon:"fas fa-file-word text-primary"},{value:"excel",label:"Excel",icon:"fas fa-file-excel text-success"},{value:"powerpoint",label:"PowerPoint",icon:"fas fa-file-powerpoint text-warning"},{value:"archive",label:"Archives",icon:"fas fa-file-archive text-secondary"},{value:"text",label:"Texte",icon:"fas fa-file-alt text-muted"},{value:"other",label:"Autres",icon:"fas fa-file"}]}},computed:{hasActiveFilters(){return!!(this.selectedType||this.selectedPerson||this.selectedService)},filteredPersons(){if(!this.personSearch)return this.persons;const e=this.personSearch.toLowerCase();return this.persons.filter(s=>`${s.prenom} ${s.nom}`.toLowerCase().includes(e)||s.email.toLowerCase().includes(e))},currentFilters(){return{type:this.selectedType,person:this.selectedPerson,service:this.selectedService}}},watch:{currentFilters:{deep:!0,handler(e){this.$emit("update:modelValue",e),this.$emit("filter-change",e)}}},mounted(){this.fetchFilterOptions(),document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{toggleFilter(e){this.activeFilter===e?this.activeFilter=null:this.activeFilter=e},handleClickOutside(e){const s=e.target;s.closest(".filter-dropdown")||(this.activeFilter=null)},selectType(e){this.selectedType=e,this.activeFilter=null,this.showServiceAccessDenied=!1},selectPerson(e){this.selectedPerson=e,this.activeFilter=null,this.showServiceAccessDenied=!1},selectService(e){this.currentUserService&&e!==this.currentUserService?(this.showServiceAccessDenied=!0,this.selectedService=null,setTimeout(()=>{this.showServiceAccessDenied=!1},5e3)):(this.selectedService=e,this.showServiceAccessDenied=!1),this.activeFilter=null},clearFilter(e){"type"===e?this.selectedType=null:"person"===e?this.selectedPerson=null:"service"===e&&(this.selectedService=null),this.showServiceAccessDenied=!1},resetAllFilters(){this.selectedType=null,this.selectedPerson=null,this.selectedService=null,this.showServiceAccessDenied=!1,this.activeFilter=null},getTypeLabel(e){const s=this.documentTypes.find(s=>s.value===e);return s?s.label:e},getPersonLabel(e){const s=this.persons.find(s=>s.id===e);return s?`${s.prenom} ${s.nom}`:""},getServiceLabel(e){const s=this.services.find(s=>s.id===e);return s?s.nom:""},async fetchFilterOptions(){console.log("ðŸ”„ Chargement des options de filtres (appels directs)"),this.loadingPersons=!0;try{const e=await ie.A.get("/users");this.persons=e.data.data||e.data||[],console.log(`âœ… ${this.persons.length} personne(s) chargÃ©e(s):`,this.persons)}catch(e){console.error("âŒ Erreur lors du chargement des personnes:",e),this.persons=[]}finally{this.loadingPersons=!1}this.loadingServices=!0;try{const e=await ie.A.get("/services");this.services=e.data.data||e.data||[],console.log(`âœ… ${this.services.length} service(s) chargÃ©(s):`,this.services)}catch(e){console.error("âŒ Erreur lors du chargement des services:",e),this.services=[]}finally{this.loadingServices=!1}try{const e=this.$store.state.user;e&&e.service_id&&(this.currentUserService=e.service_id,console.log(`âœ… Service utilisateur (depuis store): ${this.currentUserService}`))}catch(e){console.error("âŒ Erreur lors de la rÃ©cupÃ©ration du service utilisateur:",e)}}}}),oe=t(1241);const re=(0,oe.A)(ne,[["render",ae],["__scopeId","data-v-7ef9309e"]]);var ce=re,ue=t(4373),de=t(1804),he=(0,l.pM)({name:"LayoutDashView",components:{Dialog:S.A,DocumentFilters:ce},setup(){const e=(0,_.s)(),s=(0,x.d)();return{dialog:e,toast:s}},data(){return{displayNewModal:!1,globalQuery:"",globalSearchTimer:null,globalFilters:{},unreadCount:0,pollInterval:null}},computed:{userName(){return this.$store.state.user&&this.$store.state.user.name?this.$store.state.user.name:"Utilisateur"},isAdmin(){return"1"===this.$store.getters.userRole}},watch:{$route(){this.$nextTick(()=>{window.dispatchEvent(new CustomEvent("global-filters-change",{detail:this.globalFilters})),console.log("ðŸ”„ Filtres rÃ©-Ã©mis aprÃ¨s changement de route:",this.globalFilters)})}},methods:{showCreateModal(){this.dialog.open(T.A,{props:{header:"Ajouter un document",style:{width:"50vw"},modal:!0},onClose:()=>{console.log("ðŸ”” Modal fermÃ© depuis LayoutDashView - Ã‰mission Ã©vÃ©nement"),setTimeout(()=>{de["default"]&&de["default"].emit&&de.q&&de["default"].emit(de.q.DOCUMENT_CREATED)},200)}})},async logout(){try{localStorage.removeItem("yamsdigital_session"),localStorage.removeItem("auth_token"),this.$store.commit("SET_AUTH_STATUS",!1),this.$store.commit("SET_USER",null),this.$router.replace("/connexion"),this.$store.dispatch("logout").catch(e=>{console.error("Erreur backend lors de la dÃ©connexion:",e)})}catch(e){console.error("Erreur lors de la dÃ©connexion:",e),this.$router.replace("/connexion")}},openNewModal(){this.displayNewModal=!0},createNewFolder(){console.log("CrÃ©er un nouveau dossier"),this.displayNewModal=!1},createNewDocument(){console.log("CrÃ©er un nouveau document"),this.displayNewModal=!1},createNewSpreadsheet(){console.log("CrÃ©er une nouvelle feuille de calcul"),this.displayNewModal=!1},createNewPresentation(){console.log("CrÃ©er une nouvelle prÃ©sentation"),this.displayNewModal=!1},uploadFile(){console.log("Importer un fichier"),this.displayNewModal=!1},onGlobalSearchInput(){this.globalSearchTimer&&clearTimeout(this.globalSearchTimer),this.globalSearchTimer=setTimeout(()=>{window.dispatchEvent(new CustomEvent("global-search",{detail:{q:this.globalQuery}}))},400)},submitGlobalSearch(){const e=(this.globalQuery||"").trim();if(e){console.log("Recherche globale soumise:",e);try{localStorage.setItem("globalSearchQuery",e)}catch(s){console.error("Erreur lors de la sauvegarde de la recherche:",s)}this.$router.push({path:"/dashboard/search",query:{q:e}}).catch(e=>{console.error("Erreur de navigation:",e)}),window.dispatchEvent(new CustomEvent("global-search",{detail:{q:e}})),console.log("Ã‰vÃ©nement global-search Ã©mis")}},async fetchUnreadCount(){try{const e=await ue.A.get("/api/system/notifications/unread-count");console.log("API response for notifications:",e.data);const s=e.data.unread_count;s>this.unreadCount&&0!==this.unreadCount&&this.toast.add({severity:"info",summary:"Nouveau document partagÃ©",detail:"Vous avez reÃ§u un nouveau document",life:5e3}),this.unreadCount=s}catch(e){console.error("Erreur de rÃ©cupÃ©ration des notifications:",e)}},onFiltersChange(e){console.log("ðŸ” Filtres globaux changÃ©s (indÃ©pendants de la vue):",e);try{localStorage.setItem("globalFilters",JSON.stringify(e)),console.log("ðŸ’¾ Filtres sauvegardÃ©s:",e)}catch(s){console.error("Erreur lors de la sauvegarde des filtres:",s)}window.dispatchEvent(new CustomEvent("global-filters-change",{detail:e})),console.log("ðŸ“¢ Ã‰vÃ©nement global-filters-change Ã©mis pour toutes les vues")}},mounted(){try{const e=localStorage.getItem("globalFilters");e&&(this.globalFilters=JSON.parse(e),console.log("âœ… Filtres restaurÃ©s:",this.globalFilters))}catch(e){console.error("Erreur lors de la restauration des filtres:",e)}this.$nextTick(()=>{window.dispatchEvent(new CustomEvent("global-filters-change",{detail:this.globalFilters})),console.log("ðŸ“¢ Filtres globaux Ã©mis au chargement:",this.globalFilters)}),this.fetchUnreadCount().then(()=>{this.unreadCount>0&&this.toast.add({severity:"info",summary:"Bienvenue !",detail:`Vous avez ${this.unreadCount} document(s) partagÃ©(s) non lu(s)`,life:5e3})}),this.pollInterval=setInterval(this.fetchUnreadCount,3e4),window.addEventListener("notifications-read",()=>{this.fetchUnreadCount()})},beforeUnmount(){clearInterval(this.pollInterval),window.removeEventListener("notifications-read",()=>{this.fetchUnreadCount()})}});const pe=(0,oe.A)(he,[["render",E],["__scopeId","data-v-dfc5c27a"]]);var ve=pe},1804:function(e,s,t){t.d(s,{B:function(){return a},q:function(){return i}});t(4114),t(8111),t(2489),t(7588);var l=t(144);const a=(0,l.Kh)({listeners:{},emit(e,...s){this.listeners[e]&&this.listeners[e].forEach(e=>{e(...s)})},on(e,s){return this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(s),()=>{this.listeners[e]=this.listeners[e].filter(e=>e!==s)}},off(e){this.listeners[e]&&delete this.listeners[e]}}),i={DOCUMENT_DELETED:"document:deleted",DOCUMENT_CREATED:"document:created",DOCUMENT_UPDATED:"document:updated",DOCUMENT_RESTORED:"document:restored",DOCUMENT_FORCE_DELETED:"document:force_deleted"}},4412:function(e,s,t){t.d(s,{A:function(){return c}});var l=t(9361),a=t(6056),i={root:function(e){var s=e.instance,t=e.props;return["p-inputtextarea p-inputtext p-component",{"p-filled":s.filled,"p-inputtextarea-resizable ":t.autoResize,"p-invalid":t.invalid,"p-variant-filled":t.variant?"filled"===t.variant:"filled"===s.$primevue.config.inputStyle}]}},n=a.A.extend({name:"textarea",classes:i}),o=t(6768),r={name:"BaseTextarea",extends:l.A,props:{modelValue:null,autoResize:Boolean,invalid:{type:Boolean,default:!1},variant:{type:String,default:null}},style:n,provide:function(){return{$parentInstance:this}}},c={name:"Textarea",extends:r,inheritAttrs:!1,emits:["update:modelValue"],mounted:function(){this.$el.offsetParent&&this.autoResize&&this.resize()},updated:function(){this.$el.offsetParent&&this.autoResize&&this.resize()},methods:{resize:function(){this.$el.style.height="auto",this.$el.style.height=this.$el.scrollHeight+"px",parseFloat(this.$el.style.height)>=parseFloat(this.$el.style.maxHeight)?(this.$el.style.overflowY="scroll",this.$el.style.height=this.$el.style.maxHeight):this.$el.style.overflow="hidden"},onInput:function(e){this.autoResize&&this.resize(),this.$emit("update:modelValue",e.target.value)}},computed:{filled:function(){return null!=this.modelValue&&this.modelValue.toString().length>0},ptmParams:function(){return{context:{disabled:this.$attrs.disabled||""===this.$attrs.disabled}}}}},u=["value","aria-invalid"];function d(e,s,t,l,a,i){return(0,o.uX)(),(0,o.CE)("textarea",(0,o.v6)({class:e.cx("root"),value:e.modelValue,"aria-invalid":e.invalid||void 0,onInput:s[0]||(s[0]=function(){return i.onInput&&i.onInput.apply(i,arguments)})},e.ptmi("root",i.ptmParams)),null,16,u)}c.render=d},4592:function(e,s,t){t.d(s,{A:function(){return c}});var l=t(9361),a=t(6056),i={root:function(e){var s=e.instance,t=e.props;return["p-inputtext p-component",{"p-filled":s.filled,"p-inputtext-sm":"small"===t.size,"p-inputtext-lg":"large"===t.size,"p-invalid":t.invalid,"p-variant-filled":t.variant?"filled"===t.variant:"filled"===s.$primevue.config.inputStyle}]}},n=a.A.extend({name:"inputtext",classes:i}),o=t(6768),r={name:"BaseInputText",extends:l.A,props:{modelValue:null,size:{type:String,default:null},invalid:{type:Boolean,default:!1},variant:{type:String,default:null}},style:n,provide:function(){return{$parentInstance:this}}},c={name:"InputText",extends:r,inheritAttrs:!1,emits:["update:modelValue"],methods:{getPTOptions:function(e){var s="root"===e?this.ptmi:this.ptm;return s(e,{context:{filled:this.filled,disabled:this.$attrs.disabled||""===this.$attrs.disabled}})},onInput:function(e){this.$emit("update:modelValue",e.target.value)}},computed:{filled:function(){return null!=this.modelValue&&this.modelValue.toString().length>0}}},u=["value","aria-invalid"];function d(e,s,t,l,a,i){return(0,o.uX)(),(0,o.CE)("input",(0,o.v6)({class:e.cx("root"),value:e.modelValue,"aria-invalid":e.invalid||void 0,onInput:s[0]||(s[0]=function(){return i.onInput&&i.onInput.apply(i,arguments)})},i.getPTOptions("root")),null,16,u)}c.render=d}}]);
//# sourceMappingURL=112.3e4c549c.js.map