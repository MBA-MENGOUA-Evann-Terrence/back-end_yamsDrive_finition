"use strict";(self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]=self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]||[]).push([[735],{735:function(a,s,e){e.r(s),e.d(s,{default:function(){return ma}});var t=e(6768),i=e(4232);const r={class:"statistiques-container"},l={key:0,class:"loading-overlay"},n={key:1},o={class:"alert alert-info mb-3",style:{"background-color":"#e3f2fd",border:"1px solid #2196f3",padding:"15px","border-radius":"8px"}},c={key:0,style:{"margin-top":"10px"}},d={style:{background:"#f5f5f5",padding:"10px","border-radius":"4px","overflow-x":"auto","font-size":"12px"}},u={class:"stats-cards"},v={class:"stat-card"},g={class:"stat-info"},p={class:"stat-number"},k={class:"stat-card"},h={class:"stat-info"},m={class:"stat-number"},b={class:"stat-card"},y={class:"stat-info"},f={class:"stat-number"},L={class:"charts-container"},_={class:"chart-card"},C={class:"chart-header"},A={class:"time-filters"},D={class:"chart-wrapper"},w={key:0,class:"chart-loading-overlay"},E={key:1,class:"no-data-message"},X={class:"chart-card"},R={class:"chart-wrapper"},B={key:0,class:"no-data-message"},S={class:"charts-container"},K={class:"chart-card full-width"},q={class:"chart-wrapper"},F={key:0,class:"chart-loading-overlay"},U={key:1,class:"no-data-message"},x={class:"sharing-section"},T={class:"sharing-stats-grid"},O={class:"stat-content"},P={class:"stat-value"},W={class:"sharing-charts-grid"},I={class:"chart-card animated-card"},M={class:"chart-wrapper"},Y={key:0,class:"chart-loading-overlay"},$={key:1,class:"no-data-message"},j={class:"chart-card animated-card"},z={class:"chart-wrapper"},Q={key:0,class:"chart-loading-overlay"},V={key:1,class:"no-data-message"},H={class:"sharing-timeline-card animated-card"},N={key:0,class:"timeline-wrapper"},G={class:"timeline-content"},J={class:"timeline-header"},Z={class:"sender"},aa={class:"receiver"},sa={class:"timeline-body"},ea={class:"document-name"},ta={class:"share-date"},ia={key:1,class:"no-data-message"},ra={key:0,class:"recent-actions-card"},la={class:"actions-list"},na={class:"action-details"},oa=["innerHTML"],ca={class:"action-time"};function da(a,s,e,da,ua,va){const ga=(0,t.g2)("Chart");return(0,t.uX)(),(0,t.CE)("div",r,[a.isLoading?((0,t.uX)(),(0,t.CE)("div",l,s[4]||(s[4]=[(0,t.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,t.Lk)("p",null,"Chargement des statistiques...",-1)]))):((0,t.uX)(),(0,t.CE)("div",n,[s[30]||(s[30]=(0,t.Lk)("h1",{class:"page-title"},"Tableau de bord analytique",-1)),(0,t.Lk)("div",o,[s[5]||(s[5]=(0,t.Lk)("h5",{style:{margin:"0 0 10px 0"}},"Debug Statistiques",-1)),(0,t.Lk)("button",{onClick:s[0]||(s[0]=(...s)=>a.testApiCalls&&a.testApiCalls(...s)),style:{background:"#2196f3",color:"white",border:"none",padding:"8px 16px","border-radius":"4px",cursor:"pointer"}},"Tester les appels API"),a.debugInfo?((0,t.uX)(),(0,t.CE)("div",c,[(0,t.Lk)("pre",d,(0,i.v_)(JSON.stringify(a.debugInfo,null,2)),1)])):(0,t.Q3)("",!0)]),(0,t.Lk)("div",u,[(0,t.Lk)("div",v,[s[7]||(s[7]=(0,t.Lk)("div",{class:"stat-icon"},[(0,t.Lk)("i",{class:"fas fa-file-alt"})],-1)),(0,t.Lk)("div",g,[s[6]||(s[6]=(0,t.Lk)("h3",null,"Fichiers totaux",-1)),(0,t.Lk)("p",p,(0,i.v_)(a.totalFiles),1)])]),(0,t.Lk)("div",k,[s[9]||(s[9]=(0,t.Lk)("div",{class:"stat-icon"},[(0,t.Lk)("i",{class:"fas fa-share-alt"})],-1)),(0,t.Lk)("div",h,[s[8]||(s[8]=(0,t.Lk)("h3",null,"Fichiers partagÃ©s",-1)),(0,t.Lk)("p",m,(0,i.v_)(a.sharedFiles),1)])]),(0,t.Lk)("div",b,[s[11]||(s[11]=(0,t.Lk)("div",{class:"stat-icon"},[(0,t.Lk)("i",{class:"fas fa-users"})],-1)),(0,t.Lk)("div",y,[s[10]||(s[10]=(0,t.Lk)("h3",null,"Utilisateurs actifs",-1)),(0,t.Lk)("p",f,(0,i.v_)(a.activeUsers),1)])])]),(0,t.Lk)("div",L,[(0,t.Lk)("div",_,[(0,t.Lk)("div",C,[s[12]||(s[12]=(0,t.Lk)("h2",null,"ActivitÃ© des documents",-1)),(0,t.Lk)("div",A,[(0,t.Lk)("button",{onClick:s[1]||(s[1]=s=>a.setPeriod("activity","week")),class:(0,i.C4)({active:"week"===a.activityPeriod})},"Semaine",2),(0,t.Lk)("button",{onClick:s[2]||(s[2]=s=>a.setPeriod("activity","month")),class:(0,i.C4)({active:"month"===a.activityPeriod})},"Mois",2),(0,t.Lk)("button",{onClick:s[3]||(s[3]=s=>a.setPeriod("activity","year")),class:(0,i.C4)({active:"year"===a.activityPeriod})},"AnnÃ©e",2)])]),(0,t.Lk)("div",D,[a.isActivityLoading?((0,t.uX)(),(0,t.CE)("div",w,s[13]||(s[13]=[(0,t.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1)]))):a.activityData&&a.activityData.labels&&0!==a.activityData.labels.length?((0,t.uX)(),(0,t.Wv)(ga,{key:`activity-${a.activityPeriod}`,type:"line",data:a.activityData,options:a.chartOptions,class:"chart-content"},null,8,["data","options"])):((0,t.uX)(),(0,t.CE)("div",E," Aucune donnÃ©e disponible "))])]),(0,t.Lk)("div",X,[s[14]||(s[14]=(0,t.Lk)("div",{class:"chart-header"},[(0,t.Lk)("h2",null,"RÃ©partition du stockage")],-1)),(0,t.Lk)("div",R,[a.storageData&&a.storageData.labels&&0!==a.storageData.labels.length?((0,t.uX)(),(0,t.Wv)(ga,{key:"storage-chart",type:"doughnut",data:a.storageData,options:a.doughnutOptions,class:"chart-content"},null,8,["data","options"])):((0,t.uX)(),(0,t.CE)("div",B," Aucune donnÃ©e disponible "))])])]),(0,t.Lk)("div",S,[(0,t.Lk)("div",K,[s[16]||(s[16]=(0,t.Lk)("div",{class:"chart-header"},[(0,t.Lk)("h2",null,"Actions des utilisateurs (6 derniers mois)"),(0,t.Lk)("p",{class:"text-muted mb-0",style:{"font-size":"0.85rem"}},"CrÃ©ation, Suppression, Partage, Modification, TÃ©lÃ©chargement")],-1)),(0,t.Lk)("div",q,[a.isUserActionsLoading?((0,t.uX)(),(0,t.CE)("div",F,s[15]||(s[15]=[(0,t.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1)]))):a.userActivityData&&a.userActivityData.labels&&0!==a.userActivityData.labels.length?((0,t.uX)(),(0,t.Wv)(ga,{key:"user-actions-chart",type:"bar",data:a.userActivityData,options:a.barOptions,class:"chart-content"},null,8,["data","options"])):((0,t.uX)(),(0,t.CE)("div",U," Aucune donnÃ©e disponible "))])])]),(0,t.Lk)("div",x,[s[28]||(s[28]=(0,t.Lk)("div",{class:"section-header"},[(0,t.Lk)("h2",null,[(0,t.Lk)("i",{class:"fas fa-share-nodes me-2"}),(0,t.eW)("Partages de Documents")]),(0,t.Lk)("p",{class:"section-subtitle"},"Visualisation complÃ¨te des partages entre utilisateurs et services")],-1)),(0,t.Lk)("div",T,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.sharingStats,(a,s)=>((0,t.uX)(),(0,t.CE)("div",{class:"sharing-stat-card",key:s,style:(0,i.Tr)({animationDelay:.1*s+"s"})},[(0,t.Lk)("div",{class:"stat-icon-wrapper",style:(0,i.Tr)({background:a.color})},[(0,t.Lk)("i",{class:(0,i.C4)(a.icon)},null,2)],4),(0,t.Lk)("div",O,[(0,t.Lk)("h4",null,(0,i.v_)(a.label),1),(0,t.Lk)("p",P,(0,i.v_)(a.value),1)])],4))),128))]),(0,t.Lk)("div",W,[(0,t.Lk)("div",I,[s[18]||(s[18]=(0,t.Lk)("div",{class:"chart-header"},[(0,t.Lk)("h3",null,[(0,t.Lk)("i",{class:"fas fa-user-friends me-2"}),(0,t.eW)("Documents EnvoyÃ©s par Utilisateur")])],-1)),(0,t.Lk)("div",M,[a.isSharingLoading?((0,t.uX)(),(0,t.CE)("div",Y,s[17]||(s[17]=[(0,t.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1)]))):a.sharingByUserData&&a.sharingByUserData.labels&&0!==a.sharingByUserData.labels.length?((0,t.uX)(),(0,t.Wv)(ga,{key:"sharing-by-user",type:"bar",data:a.sharingByUserData,options:a.sharingBarOptions,class:"chart-content"},null,8,["data","options"])):((0,t.uX)(),(0,t.CE)("div",$," Aucun partage enregistrÃ© "))])]),(0,t.Lk)("div",j,[s[20]||(s[20]=(0,t.Lk)("div",{class:"chart-header"},[(0,t.Lk)("h3",null,[(0,t.Lk)("i",{class:"fas fa-building me-2"}),(0,t.eW)("Documents EnvoyÃ©s par Service")])],-1)),(0,t.Lk)("div",z,[a.isSharingLoading?((0,t.uX)(),(0,t.CE)("div",Q,s[19]||(s[19]=[(0,t.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1)]))):a.sharingByServiceData&&a.sharingByServiceData.labels&&0!==a.sharingByServiceData.labels.length?((0,t.uX)(),(0,t.Wv)(ga,{key:"sharing-by-service",type:"doughnut",data:a.sharingByServiceData,options:a.sharingDoughnutOptions,class:"chart-content"},null,8,["data","options"])):((0,t.uX)(),(0,t.CE)("div",V," Aucun partage par service "))])])]),(0,t.Lk)("div",H,[s[27]||(s[27]=(0,t.Lk)("div",{class:"chart-header"},[(0,t.Lk)("h3",null,[(0,t.Lk)("i",{class:"fas fa-clock me-2"}),(0,t.eW)("Documents ReÃ§us par Utilisateur")])],-1)),a.sharingTimeline&&a.sharingTimeline.length>0?((0,t.uX)(),(0,t.CE)("div",N,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.sharingTimeline,(a,e)=>((0,t.uX)(),(0,t.CE)("div",{key:e,class:"timeline-item",style:(0,i.Tr)({animationDelay:.05*e+"s"})},[s[26]||(s[26]=(0,t.Lk)("div",{class:"timeline-marker"},[(0,t.Lk)("i",{class:"fas fa-share-alt"})],-1)),(0,t.Lk)("div",G,[(0,t.Lk)("div",J,[(0,t.Lk)("span",Z,[s[21]||(s[21]=(0,t.Lk)("i",{class:"fas fa-user me-1"},null,-1)),(0,t.eW)((0,i.v_)(a.sender),1)]),s[23]||(s[23]=(0,t.Lk)("i",{class:"fas fa-arrow-right mx-2"},null,-1)),(0,t.Lk)("span",aa,[s[22]||(s[22]=(0,t.Lk)("i",{class:"fas fa-user me-1"},null,-1)),(0,t.eW)((0,i.v_)(a.receiver),1)])]),(0,t.Lk)("div",sa,[(0,t.Lk)("span",ea,[s[24]||(s[24]=(0,t.Lk)("i",{class:"fas fa-file me-1"},null,-1)),(0,t.eW)((0,i.v_)(a.document),1)]),(0,t.Lk)("span",ta,[s[25]||(s[25]=(0,t.Lk)("i",{class:"fas fa-calendar me-1"},null,-1)),(0,t.eW)((0,i.v_)(a.date),1)])])])],4))),128))])):((0,t.uX)(),(0,t.CE)("div",ia,"Aucun partage rÃ©cent"))])]),a.recentActions.length>0?((0,t.uX)(),(0,t.CE)("div",ra,[s[29]||(s[29]=(0,t.Lk)("div",{class:"chart-header"},[(0,t.Lk)("h2",null,"Actions RÃ©centes")],-1)),(0,t.Lk)("ul",la,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.recentActions,a=>((0,t.uX)(),(0,t.CE)("li",{key:a.id,class:"action-item"},[(0,t.Lk)("i",{class:(0,i.C4)([a.icon,"action-icon"])},null,2),(0,t.Lk)("div",na,[(0,t.Lk)("p",{innerHTML:a.description},null,8,oa),(0,t.Lk)("span",ca,(0,i.v_)(a.time),1)])]))),128))])])):(0,t.Q3)("",!0)]))])}e(8111),e(1701);var ua=e(144),va=e(1526),ga=e(9520),pa=(0,t.pM)({name:"StatistiquesView",components:{Chart:ga.A},setup(){const a=(0,ua.KR)(!0),s=(0,ua.KR)(!1),e=(0,ua.KR)(!1),i=(0,ua.KR)(!1),r=(0,ua.KR)(0),l=(0,ua.KR)(0),n=(0,ua.KR)(0),o=(0,ua.KR)({labels:[],datasets:[]}),c=(0,ua.KR)({labels:[],datasets:[]}),d=(0,ua.KR)({labels:[],datasets:[]}),u=(0,ua.KR)([]),v=(0,ua.KR)(null),g=(0,ua.KR)([]),p=(0,ua.KR)({labels:[],datasets:[]}),k=(0,ua.KR)({labels:[],datasets:[]}),h=(0,ua.KR)([]),m=(0,ua.KR)("month"),b={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#333"}}},scales:{x:{grid:{color:"rgba(0, 0, 0, 0.1)"},ticks:{color:"#333"}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.1)"},ticks:{color:"#333"}}}},y={...b},f={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#333",font:{weight:"bold"}}}},cutout:"60%"},L={...b,animation:{duration:1500,easing:"easeInOutQuart"},plugins:{legend:{display:!0,labels:{color:"#333",font:{weight:"bold"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14},bodyFont:{size:13}}}},_={...f,animation:{animateRotate:!0,animateScale:!0,duration:2e3},plugins:{legend:{position:"bottom",labels:{color:"#333",font:{weight:"bold"},padding:15}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12}}},C=async()=>{s.value=!0;try{const a=await va.A.get(`/statistiques/activite-documents?period=${m.value}`);a.data&&a.data.labels&&a.data.datasets?(await(0,t.dY)(),o.value=a.data):(console.warn("DonnÃ©es d'activitÃ© des documents invalides"),o.value={labels:[],datasets:[]})}catch(a){console.error("Erreur lors de la rÃ©cupÃ©ration des donnÃ©es d'activitÃ© des documents:",a),o.value={labels:[],datasets:[]}}finally{await(0,t.dY)(),s.value=!1}},A=async()=>{e.value=!0;try{console.log("ðŸ“Š Chargement actions utilisateurs (6 derniers mois)");const a=await va.A.get("/statistiques/actions-utilisateurs");console.log("âœ… DonnÃ©es actions utilisateurs reÃ§ues:",a.data),a.data&&a.data.labels&&a.data.datasets?(await(0,t.dY)(),d.value=a.data,console.log("âœ… Graphique actions utilisateurs mis Ã  jour"),console.log("ðŸ“Š Actions suivies:",a.data.datasets.map(a=>a.label).join(", "))):(console.warn("âš ï¸ Structure de donnÃ©es inattendue pour actions utilisateurs:",a.data),d.value={labels:[],datasets:[]})}catch(a){console.error("âŒ Erreur lors de la rÃ©cupÃ©ration des donnÃ©es d'actions des utilisateurs:",a),console.error("DÃ©tails:",a.response?.data),d.value={labels:[],datasets:[]}}finally{await(0,t.dY)(),e.value=!1}},D=async()=>{i.value=!0;try{console.log("ðŸ“Š Chargement des donnÃ©es de partages");const a=await va.A.get("/statistiques/partages-documents");if(console.log("âœ… DonnÃ©es de partages reÃ§ues:",a.data),a.data&&a.data.data){const s=a.data.data,e=(s.documents_par_utilisateur||[]).length,t=(s.documents_par_service||[]).length,i=(s.documents_recus_par_utilisateur||[]).length;if(g.value=[{label:"Total Partages",value:s.total_partages||0,icon:"fas fa-share-alt",color:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},{label:"Utilisateurs Ã‰metteurs",value:e,icon:"fas fa-user-check",color:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"},{label:"Services ImpliquÃ©s",value:t,icon:"fas fa-building",color:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"},{label:"Utilisateurs RÃ©cepteurs",value:i,icon:"fas fa-user-friends",color:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)"}],s.documents_par_utilisateur&&Array.isArray(s.documents_par_utilisateur)&&(p.value={labels:s.documents_par_utilisateur.map(a=>a.user_name),datasets:[{label:"Documents envoyÃ©s",data:s.documents_par_utilisateur.map(a=>a.total_envoyes),backgroundColor:"rgba(102, 126, 234, 0.8)",borderColor:"rgba(102, 126, 234, 1)",borderWidth:2,borderRadius:8,hoverBackgroundColor:"rgba(118, 75, 162, 0.9)"}]}),s.documents_par_service&&Array.isArray(s.documents_par_service)){const a=["rgba(102, 126, 234, 0.8)","rgba(245, 87, 108, 0.8)","rgba(74, 172, 254, 0.8)","rgba(67, 233, 123, 0.8)","rgba(240, 147, 251, 0.8)","rgba(255, 159, 64, 0.8)"];k.value={labels:s.documents_par_service.map(a=>a.service_nom),datasets:[{data:s.documents_par_service.map(a=>a.total_envoyes),backgroundColor:a,borderColor:a.map(a=>a.replace("0.8","1")),borderWidth:3,hoverOffset:15}]}}s.documents_recus_par_utilisateur&&Array.isArray(s.documents_recus_par_utilisateur)&&(h.value=s.documents_recus_par_utilisateur.map((a,e)=>{const t=s.documents_par_utilisateur&&s.documents_par_utilisateur[0]?s.documents_par_utilisateur[0].user_name:"Utilisateur";return{sender:t,receiver:a.user_name,document:`${a.total_recus} document(s) reÃ§u(s)`,date:(new Date).toLocaleString("fr-FR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}})),console.log("âœ… DonnÃ©es de partages traitÃ©es avec succÃ¨s"),console.log("ðŸ“Š Total partages:",s.total_partages),console.log("ðŸ‘¥ Utilisateurs Ã©metteurs:",e),console.log("ðŸ¢ Services:",t)}}catch(a){console.error("âŒ Erreur lors de la rÃ©cupÃ©ration des donnÃ©es de partages:",a),console.error("DÃ©tails:",a.response?.data),g.value=[],p.value={labels:[],datasets:[]},k.value={labels:[],datasets:[]},h.value=[]}finally{await(0,t.dY)(),i.value=!1}},w=async()=>{a.value=!0;try{const[a,s,e]=await Promise.all([va.A.get("/statistiques/globales"),va.A.get("/statistiques/repartition-stockage"),va.A.get("/statistiques/actions-recentes")]);if(a.data&&a.data.data){const s=a.data.data;r.value=s.total_documents||0,l.value=s.total_shared_documents||0,n.value=s.total_users||0}if(s.data&&s.data.data){const a=s.data.data,e=Object.keys(a).map(a=>a.charAt(0).toUpperCase()+a.slice(1)),t=Object.values(a);c.value={labels:e,datasets:[{data:t,backgroundColor:["#42A5F5","#66BB6A","#FFA726","#26A69A","#AB47BC","#78909C"],hoverBackgroundColor:["#64B5F6","#81C784","#FFB74D","#4DB6AC","#BA68C8","#90A4AE"]}]}}u.value=e.data,await Promise.all([C(),A(),D()])}catch(s){console.error("Erreur lors de la rÃ©cupÃ©ration des statistiques initiales:",s.response?.data?.message||s.message)}finally{a.value=!1}},E=(a,s)=>{if("activity"===a){if(m.value===s)return;m.value=s,C()}},X=async()=>{v.value={testing:!0,results:{}};const a=["/statistiques/globales","/statistiques/repartition-stockage","/statistiques/actions-recentes","/statistiques/activite-documents?period=month","/statistiques/actions-utilisateurs"];for(const e of a)try{console.log(`Testing: ${e}`);const a=await va.A.get(e);v.value.results[e]={status:a.status,data:a.data,success:!0}}catch(s){console.error(`Error on ${e}:`,s),v.value.results[e]={status:s.response?.status||"Network Error",error:s.message,response:s.response?.data,success:!1}}v.value.testing=!1};return(0,t.sV)(()=>{setTimeout(()=>{w()},100)}),{isLoading:a,isActivityLoading:s,isUserActionsLoading:e,isSharingLoading:i,totalFiles:r,sharedFiles:l,activeUsers:n,activityData:o,storageData:c,userActivityData:d,recentActions:u,sharingStats:g,sharingByUserData:p,sharingByServiceData:k,sharingTimeline:h,chartOptions:b,barOptions:y,doughnutOptions:f,sharingBarOptions:L,sharingDoughnutOptions:_,activityPeriod:m,setPeriod:E,debugInfo:v,testApiCalls:X}}}),ka=e(1241);const ha=(0,ka.A)(pa,[["render",da],["__scopeId","data-v-4a9eefee"]]);var ma=ha}}]);
//# sourceMappingURL=735.6cc8a347.js.map