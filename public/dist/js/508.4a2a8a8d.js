"use strict";(self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]=self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]||[]).push([[508],{2565:function(e,s,t){t.d(s,{A:function(){return a}});var o=t(309),a=(0,o.l7)()},8496:function(e,s,t){t.r(s),t.d(s,{default:function(){return I}});var o=t(6768);const a={class:"profile-view p-4"},r={class:"grid"},l={class:"col-12 md:col-6"},i={class:"p-fluid"},d={class:"field mb-4"},n={class:"field mb-4"},c={class:"col-12 md:col-6"},u={class:"p-fluid"},m={class:"field mb-4"},p={class:"field mb-4"},f={class:"col-12 text-center mt-4"};function v(e,s,t,v,b,k){const h=(0,o.g2)("Toast"),w=(0,o.g2)("InputText"),y=(0,o.g2)("Card"),g=(0,o.g2)("Password"),L=(0,o.g2)("Button");return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.bF)(h),(0,o.Lk)("div",r,[(0,o.Lk)("div",l,[(0,o.bF)(y,{class:"mb-4"},{title:(0,o.k6)(()=>s[4]||(s[4]=[(0,o.Lk)("i",{class:"fas fa-user-edit me-2"},null,-1),(0,o.eW)(" Informations Personnelles ",-1)])),content:(0,o.k6)(()=>[(0,o.Lk)("div",i,[(0,o.Lk)("div",d,[s[5]||(s[5]=(0,o.Lk)("label",{for:"name"},"Nom d'utilisateur",-1)),(0,o.bF)(w,{id:"name",modelValue:e.user.name,"onUpdate:modelValue":s[0]||(s[0]=s=>e.user.name=s),type:"text"},null,8,["modelValue"])]),(0,o.Lk)("div",n,[s[6]||(s[6]=(0,o.Lk)("label",{for:"email"},"Adresse e-mail (non modifiable)",-1)),(0,o.bF)(w,{id:"email",modelValue:e.user.email,"onUpdate:modelValue":s[1]||(s[1]=s=>e.user.email=s),type:"email",disabled:!0},null,8,["modelValue"])])])]),_:1})]),(0,o.Lk)("div",c,[(0,o.bF)(y,null,{title:(0,o.k6)(()=>s[7]||(s[7]=[(0,o.Lk)("i",{class:"fas fa-key me-2"},null,-1),(0,o.eW)(" Changer le mot de passe ",-1)])),content:(0,o.k6)(()=>[(0,o.Lk)("div",u,[(0,o.Lk)("div",m,[s[8]||(s[8]=(0,o.Lk)("label",{for:"newPassword"},"Nouveau mot de passe",-1)),(0,o.bF)(g,{id:"newPassword",modelValue:e.passwords.new,"onUpdate:modelValue":s[2]||(s[2]=s=>e.passwords.new=s),feedback:!0,toggleMask:""},null,8,["modelValue"])]),(0,o.Lk)("div",p,[s[9]||(s[9]=(0,o.Lk)("label",{for:"confirmPassword"},"Confirmer le nouveau mot de passe",-1)),(0,o.bF)(g,{id:"confirmPassword",modelValue:e.passwords.confirm,"onUpdate:modelValue":s[3]||(s[3]=s=>e.passwords.confirm=s),feedback:!1,toggleMask:""},null,8,["modelValue"])])])]),_:1})])]),(0,o.Lk)("div",f,[(0,o.bF)(L,{onClick:e.updateProfile,label:"Enregistrer les modifications",icon:"pi pi-check",class:"p-button-primary p-button-lg"},null,8,["onClick"])])])}var b=t(2151),k=t(4373),h=t(4592),w=t(2775),y=t(9361),g=t(6056),L={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"},_=g.A.extend({name:"card",classes:L}),C={name:"BaseCard",extends:y.A,style:_},x={name:"Card",extends:C,inheritAttrs:!1};function $(e,s,t,a,r,l){return(0,o.uX)(),(0,o.CE)("div",(0,o.v6)({class:e.cx("root")},e.ptmi("root")),[e.$slots.header?((0,o.uX)(),(0,o.CE)("div",(0,o.v6)({key:0,class:e.cx("header")},e.ptm("header")),[(0,o.RG)(e.$slots,"header")],16)):(0,o.Q3)("",!0),(0,o.Lk)("div",(0,o.v6)({class:e.cx("body")},e.ptm("body")),[e.$slots.title||e.$slots.subtitle?((0,o.uX)(),(0,o.CE)("div",(0,o.v6)({key:0,class:e.cx("caption")},e.ptm("caption")),[e.$slots.title?((0,o.uX)(),(0,o.CE)("div",(0,o.v6)({key:0,class:e.cx("title")},e.ptm("title")),[(0,o.RG)(e.$slots,"title")],16)):(0,o.Q3)("",!0),e.$slots.subtitle?((0,o.uX)(),(0,o.CE)("div",(0,o.v6)({key:1,class:e.cx("subtitle")},e.ptm("subtitle")),[(0,o.RG)(e.$slots,"subtitle")],16)):(0,o.Q3)("",!0)],16)):(0,o.Q3)("",!0),(0,o.Lk)("div",(0,o.v6)({class:e.cx("content")},e.ptm("content")),[(0,o.RG)(e.$slots,"content")],16),e.$slots.footer?((0,o.uX)(),(0,o.CE)("div",(0,o.v6)({key:1,class:e.cx("footer")},e.ptm("footer")),[(0,o.RG)(e.$slots,"footer")],16)):(0,o.Q3)("",!0)],16)],16)}x.render=$;var E=t(1934),V=t(3810),A=(0,o.pM)({name:"ProfilView",components:{InputText:h.A,Button:w.A,Card:x,Password:E.A,Toast:V.A},setup(){const e=(0,b.d)();return{toast:e}},data(){return{user:{id:null,name:"",email:""},passwords:{new:"",confirm:""}}},mounted(){this.fetchUser()},methods:{fetchUser(){const e=this.$store.getters.user;e&&(this.user.id=e.id,this.user.name=e.name,this.user.email=e.email)},async updateProfile(){if(console.log("Début de updateProfile"),this.passwords.new&&this.passwords.new!==this.passwords.confirm)this.toast.add({severity:"error",summary:"Erreur",detail:"Les nouveaux mots de passe ne correspondent pas.",life:3e3});else try{const s={name:this.user.name};this.passwords.new&&(s.password=this.passwords.new);await k.A.put(`/api/users/${this.user.id}`,s);const t=this.$store.state.user,o={...t,name:this.user.name};console.log("Mise à jour du store avec:",o),this.$store.commit("SET_USER",o);const a=localStorage.getItem("yamsdigital_session");if(a)try{const e=JSON.parse(a);e&&e.data&&(e.data.user=o,localStorage.setItem("yamsdigital_session",JSON.stringify(e)))}catch(e){console.error("Erreur lors de la mise à jour de la session:",e)}this.toast.add({severity:"success",summary:"Succès",detail:"Votre profil a été mis à jour.",life:3e3}),this.passwords.new="",this.passwords.confirm=""}catch(s){console.error("Erreur lors de la mise à jour du profil:",s),this.toast.add({severity:"error",summary:"Erreur",detail:"Impossible de mettre à jour le profil.",life:3e3})}}}}),P=t(1241);const F=(0,P.A)(A,[["render",v],["__scopeId","data-v-4883185a"]]);var I=F}}]);
//# sourceMappingURL=508.4a2a8a8d.js.map