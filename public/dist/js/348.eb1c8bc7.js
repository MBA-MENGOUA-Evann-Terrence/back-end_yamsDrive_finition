"use strict";(self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]=self["webpackChunkskeleton_spa_vue3_bootstrap5_primevue_pwa_ts"]||[]).push([[348],{1348:function(e,t,i){i.r(t),i.d(t,{default:function(){return P}});var s=i(6768),a=i(4232);const n={class:"card service-management-card"},l={class:"card-header"},r={class:"card-body"},o={class:"p-2 rounded badge badge-secondary"};function d(e,t,i,d,u,c){const p=(0,s.g2)("AsdecodeTable");return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("div",l,[t[2]||(t[2]=(0,s.Lk)("h1",{class:"card-title"},"Gestion des services",-1)),(0,s.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...t)=>e.showCreateModal&&e.showCreateModal(...t))},t[1]||(t[1]=[(0,s.Lk)("i",{class:"fas fa-plus me-1"},null,-1),(0,s.eW)(" Nouveau service ",-1)]))]),(0,s.Lk)("div",r,[((0,s.uX)(),(0,s.Wv)(p,{ref:"serviceTable",key:e.tableKey,columns:e.columns,url:"/api/services",table:"services",onSetTotalRecords:e.updateLines,onRowClick:e.showLine,onSetSelectedRows:e.getSelection,"show-top-stats":!1,"show-bottom-stats":!1},{created_at:(0,s.k6)(e=>[(0,s.Lk)("span",o,(0,a.v_)(e.data.created_at),1)]),_:1},8,["columns","onSetTotalRecords","onRowClick","onSetSelectedRows"]))])])}var u=i(5130);const c={class:"field mb-3"},p={class:"field mb-3"},m={class:"d-flex justify-content-end"};function h(e,t,i,a,n,l){const r=(0,s.g2)("InputText"),o=(0,s.g2)("Textarea"),d=(0,s.g2)("Button");return(0,s.uX)(),(0,s.CE)("form",{onSubmit:t[2]||(t[2]=(0,u.D$)((...e)=>l.submitForm&&l.submitForm(...e),["prevent"])),class:"p-fluid"},[(0,s.Lk)("div",c,[t[3]||(t[3]=(0,s.Lk)("label",{for:"nom"},"Nom du service",-1)),(0,s.bF)(r,{id:"nom",modelValue:n.form.nom,"onUpdate:modelValue":t[0]||(t[0]=e=>n.form.nom=e),required:""},null,8,["modelValue"])]),(0,s.Lk)("div",p,[t[4]||(t[4]=(0,s.Lk)("label",{for:"description"},"Description",-1)),(0,s.bF)(o,{id:"description",modelValue:n.form.description,"onUpdate:modelValue":t[1]||(t[1]=e=>n.form.description=e),rows:"5"},null,8,["modelValue"])]),(0,s.Lk)("div",m,[(0,s.bF)(d,{type:"submit",label:l.isEditMode?"Modifier":"Enregistrer",icon:l.isEditMode?"pi pi-pencil":"pi pi-save",loading:n.isLoading},null,8,["label","icon","loading"])])],32)}i(8111),i(7588);var f=i(6587),v=i.n(f),b=i(4592),g=i(4412),y=i(2775),k={name:"FormService",components:{InputText:b.A,Textarea:g.A,Button:y.A},inject:["dialogRef"],data(){return{isLoading:!1,table:"services",form:{id:null,nom:"",description:""}}},computed:{isEditMode(){return!!(this.dialogRef&&this.dialogRef.data&&this.dialogRef.data.id)}},mounted(){this.isEditMode&&(this.form={...this.dialogRef.data})},methods:{async submitForm(){this.isLoading=!0;try{let e;e=this.isEditMode?await this.axios.post(`/api/services/${this.form.id}/update`,this.form):await this.axios.post("/api/services",this.form),e.data.success?this.handleSuccess(e.data.message):this.handleError(e.data.errors)}catch(e){console.error(e),this.handleError(["Une erreur de communication est survenue."])}finally{this.isLoading=!1}},handleSuccess(e){this.dialogRef.close(),v()("#refresh"+this.table).click(),this.$toast.add({severity:"success",summary:"Succès",detail:e||"Opération réussie",life:3e3})},handleError(e){const t=e||["Une erreur est survenue"];t.forEach(e=>{this.$toast.add({severity:"error",summary:"Erreur",detail:e,life:7e3})})},resetForm(){this.form={id:null,nom:"",description:""}}}},L=i(1241);const x=(0,L.A)(k,[["render",h],["__scopeId","data-v-92122abc"]]);var $=x;const w={class:"d-flex justify-content-end mb-3"},S=["disabled"],_={class:"spinner-border spinner-border-sm",role:"status"},R={class:"card shadow-sm"},C={class:"card-body"},E={class:"card-title text-primary mb-3"},A={class:"mb-2"},I={class:"text-muted"},V={class:"mb-0"},T={class:"text-muted"};function M(e,t,i,n,l,r){return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",w,[(0,s.Lk)("button",{class:"btn btn-sm btn-primary me-2",onClick:t[0]||(t[0]=(...e)=>r.onEditModal&&r.onEditModal(...e))},t[2]||(t[2]=[(0,s.Lk)("i",{class:"fas fa-edit"},null,-1),(0,s.eW)(" Modifier ",-1)])),(0,s.Lk)("button",{class:"btn btn-sm btn-danger",onClick:t[1]||(t[1]=(...e)=>r.onDelete&&r.onDelete(...e)),disabled:l.isLoading},[t[4]||(t[4]=(0,s.Lk)("i",{class:"fas fa-trash-alt"},null,-1)),t[5]||(t[5]=(0,s.eW)(" Supprimer ",-1)),(0,s.bo)((0,s.Lk)("div",_,t[3]||(t[3]=[(0,s.Lk)("span",{class:"visually-hidden"},"Chargement...",-1)]),512),[[u.aG,l.isLoading]])],8,S)]),(0,s.Lk)("div",R,[(0,s.Lk)("div",C,[(0,s.Lk)("h5",E,(0,a.v_)(l.service.nom),1),(0,s.Lk)("p",A,[t[6]||(t[6]=(0,s.Lk)("strong",null,"Description :",-1)),t[7]||(t[7]=(0,s.Lk)("br",null,null,-1)),(0,s.Lk)("span",I,(0,a.v_)(l.service.description),1)]),(0,s.Lk)("p",V,[t[8]||(t[8]=(0,s.Lk)("strong",null,"Créé le :",-1)),t[9]||(t[9]=(0,s.Lk)("br",null,null,-1)),(0,s.Lk)("span",T,(0,a.v_)(r.formatDate(l.service.created_at)),1)])])])],64)}var D={name:"ShowService",inject:["dialogRef"],data(){return{isLoading:!1,table:"services",service:this.dialogRef.data}},methods:{formatDate(e){const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("fr-FR",t)},onEditModal(){this.dialogRef.close(),this.$dialog.open($,{props:{header:"Modifier un service",style:{width:"50vw"},modal:!0},data:this.dialogRef.data})},onDelete(){this.dialogRef.close({delete:this.service})}}};const z=(0,L.A)(D,[["render",M],["__scopeId","data-v-e0fb9938"]]);var F=z,j=(0,s.pM)({name:"IndexService",data(){return{tableKey:0,lines:0,selection:[],columns:[{key:"nom",label:"Nom"},{key:"description",label:"Description"},{key:"created_at",label:"Ajouté le"}]}},methods:{refreshTable(){this.tableKey++},showLine(e){this.$dialog.open(F,{props:{header:"Détails du service",style:{width:"50vw"},modal:!0},data:e,onClose:e=>{e&&e.data&&(e.data.refresh&&this.refreshTable(),e.data.delete&&this.confirmDeleteService(e.data.delete))}})},updateLines(e){this.lines=e},confirmDeleteService(e){this.$confirm.require({message:`Êtes-vous sûr de vouloir supprimer le service ${e.nom} ?`,header:"Confirmation de suppression",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",acceptLabel:"Oui, supprimer",rejectLabel:"Annuler",accept:async()=>{try{await this.axios.post(`/api/services/${e.id}/destroy`),this.$toast.add({severity:"success",summary:"Succès",detail:"Service supprimé.",life:3e3}),this.refreshTable()}catch(t){const e=t.response?.data?.message||"La suppression a échoué.";this.$toast.add({severity:"error",summary:"Erreur",detail:e,life:5e3})}}})},showCreateModal(){this.$dialog.open($,{props:{header:"Ajouter un service",style:{width:"50vw"},modal:!0}})}}});const B=(0,L.A)(j,[["render",d],["__scopeId","data-v-42e9fa17"]]);var P=B},4412:function(e,t,i){i.d(t,{A:function(){return d}});var s=i(9361),a=i(6056),n={root:function(e){var t=e.instance,i=e.props;return["p-inputtextarea p-inputtext p-component",{"p-filled":t.filled,"p-inputtextarea-resizable ":i.autoResize,"p-invalid":i.invalid,"p-variant-filled":i.variant?"filled"===i.variant:"filled"===t.$primevue.config.inputStyle}]}},l=a.A.extend({name:"textarea",classes:n}),r=i(6768),o={name:"BaseTextarea",extends:s.A,props:{modelValue:null,autoResize:Boolean,invalid:{type:Boolean,default:!1},variant:{type:String,default:null}},style:l,provide:function(){return{$parentInstance:this}}},d={name:"Textarea",extends:o,inheritAttrs:!1,emits:["update:modelValue"],mounted:function(){this.$el.offsetParent&&this.autoResize&&this.resize()},updated:function(){this.$el.offsetParent&&this.autoResize&&this.resize()},methods:{resize:function(){this.$el.style.height="auto",this.$el.style.height=this.$el.scrollHeight+"px",parseFloat(this.$el.style.height)>=parseFloat(this.$el.style.maxHeight)?(this.$el.style.overflowY="scroll",this.$el.style.height=this.$el.style.maxHeight):this.$el.style.overflow="hidden"},onInput:function(e){this.autoResize&&this.resize(),this.$emit("update:modelValue",e.target.value)}},computed:{filled:function(){return null!=this.modelValue&&this.modelValue.toString().length>0},ptmParams:function(){return{context:{disabled:this.$attrs.disabled||""===this.$attrs.disabled}}}}},u=["value","aria-invalid"];function c(e,t,i,s,a,n){return(0,r.uX)(),(0,r.CE)("textarea",(0,r.v6)({class:e.cx("root"),value:e.modelValue,"aria-invalid":e.invalid||void 0,onInput:t[0]||(t[0]=function(){return n.onInput&&n.onInput.apply(n,arguments)})},e.ptmi("root",n.ptmParams)),null,16,u)}d.render=c},4592:function(e,t,i){i.d(t,{A:function(){return d}});var s=i(9361),a=i(6056),n={root:function(e){var t=e.instance,i=e.props;return["p-inputtext p-component",{"p-filled":t.filled,"p-inputtext-sm":"small"===i.size,"p-inputtext-lg":"large"===i.size,"p-invalid":i.invalid,"p-variant-filled":i.variant?"filled"===i.variant:"filled"===t.$primevue.config.inputStyle}]}},l=a.A.extend({name:"inputtext",classes:n}),r=i(6768),o={name:"BaseInputText",extends:s.A,props:{modelValue:null,size:{type:String,default:null},invalid:{type:Boolean,default:!1},variant:{type:String,default:null}},style:l,provide:function(){return{$parentInstance:this}}},d={name:"InputText",extends:o,inheritAttrs:!1,emits:["update:modelValue"],methods:{getPTOptions:function(e){var t="root"===e?this.ptmi:this.ptm;return t(e,{context:{filled:this.filled,disabled:this.$attrs.disabled||""===this.$attrs.disabled}})},onInput:function(e){this.$emit("update:modelValue",e.target.value)}},computed:{filled:function(){return null!=this.modelValue&&this.modelValue.toString().length>0}}},u=["value","aria-invalid"];function c(e,t,i,s,a,n){return(0,r.uX)(),(0,r.CE)("input",(0,r.v6)({class:e.cx("root"),value:e.modelValue,"aria-invalid":e.invalid||void 0,onInput:t[0]||(t[0]=function(){return n.onInput&&n.onInput.apply(n,arguments)})},n.getPTOptions("root")),null,16,u)}d.render=c}}]);
//# sourceMappingURL=348.eb1c8bc7.js.map